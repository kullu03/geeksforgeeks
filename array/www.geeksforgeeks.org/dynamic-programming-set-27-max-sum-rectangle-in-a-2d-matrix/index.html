<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">

<head>
       <title>Dynamic Programming | Set 27 (Maximum sum rectangle in a 2D matrix) - GeeksforGeeks</title>
       <style type="text/css" media="screen">
          @import url('http://d2o58evtke57tz.cloudfront.net/wp-content/themes/minimoo/style.css');
    </style>
      <link href="http://d2o58evtke57tz.cloudfront.net/wp-content/themes/minimoo/favicon.ico" rel="shortcut icon" />    
    
<!-- This site is optimized with the Yoast WordPress SEO plugin v1.7.1 - https://yoast.com/wordpress/plugins/seo/ -->
<link rel="canonical" href="http://www.geeksforgeeks.org/dynamic-programming-set-27-max-sum-rectangle-in-a-2d-matrix/" />
<meta property="og:locale" content="en_US" />
<meta property="og:type" content="article" />
<meta property="og:title" content="Dynamic Programming | Set 27 (Maximum sum rectangle in a 2D matrix) - GeeksforGeeks" />
<meta property="og:description" content="Given a 2D array, find the maximum sum subarray in it. For example, in the following 2D array, the maximum sum subarray is highlighted with blue rectangle and sum of this subarray is 29. This problem is mainly an extension of Largest Sum Contiguous Subarray for 1D array. The naive solution for this problem is &hellip;" />
<meta property="og:url" content="http://www.geeksforgeeks.org/dynamic-programming-set-27-max-sum-rectangle-in-a-2d-matrix/" />
<meta property="og:site_name" content="GeeksforGeeks" />
<meta property="article:tag" content="Dynamic Programming" />
<meta property="article:section" content="Arrays" />
<meta property="article:published_time" content="2013-02-27T17:26:47+00:00" />
<meta property="article:modified_time" content="2013-06-21T15:38:22+00:00" />
<meta property="og:updated_time" content="2013-06-21T15:38:22+00:00" />
<meta property="og:image" content="http://d2o58evtke57tz.cloudfront.net/wp-content/uploads/rectangle-11.png" />
<!-- / Yoast WordPress SEO plugin. -->

<link rel='stylesheet' id='wp-quicklatex-format-css'  href='http://d2o58evtke57tz.cloudfront.net/wp-content/plugins/wp-quicklatex/css/quicklatex-format.css?ver=4.0.1' type='text/css' media='all' />
<link rel='stylesheet' id='bbp-default-css'  href='http://d2o58evtke57tz.cloudfront.net/wp-content/plugins/bbpress/templates/default/css/bbpress.css?ver=2.5.4-5380' type='text/css' media='screen' />
<link rel='stylesheet' id='wp-pagenavi-css'  href='http://d2o58evtke57tz.cloudfront.net/wp-content/plugins/wp-pagenavi/pagenavi-css.css?ver=2.70' type='text/css' media='all' />
<script type='text/javascript' src='http://d2o58evtke57tz.cloudfront.net/wp-includes/js/jquery/jquery.js?ver=1.11.1'></script>
<script type='text/javascript' src='http://d2o58evtke57tz.cloudfront.net/wp-includes/js/jquery/jquery-migrate.min.js?ver=1.2.1'></script>
<script type='text/javascript' src='http://d2o58evtke57tz.cloudfront.net/wp-content/plugins/wp-quicklatex/js/wp-quicklatex-frontend.js?ver=1.0'></script>

<!-- Bad Behavior 2.2.16 run time: 1.604 ms -->
<script type="text/javascript">
<!--
function bb2_addLoadEvent(func) {
	var oldonload = window.onload;
	if (typeof window.onload != 'function') {
		window.onload = func;
	} else {
		window.onload = function() {
			oldonload();
			func();
		}
	}
}

bb2_addLoadEvent(function() {
	for ( i=0; i < document.forms.length; i++ ) {
		if (document.forms[i].method == 'post') {
			var myElement = document.createElement('input');
			myElement.setAttribute('type', 'hidden');
			myElement.name = 'bb2_screener_';
			myElement.value = '1417111056 14.139.160.234';
			document.forms[i].appendChild(myElement);
		}
	}
});
// --></script>
		<style type="text/css" id="syntaxhighlighteranchor"></style>
   <meta name="google-site-verification" content="rHK2v8_zzuAZQY8JHAzbllDN8u-aQxcn2Kqnp67Old0" />
</head>

<body>
<!-- o4dI0sCXUgoSONabbd8mbZ4SA3E -->    
    <div id="wrapper">
        <div class="blog-info">
                <h1 class="blog-title">
                <a href="http://www.geeksforgeeks.org" title="GeeksforGeeks">GeeksforGeeks</a>
            </h1>
       
            <div class="blog-description">
                A computer science portal for geeks            </div>
        </div>
        <b><p>  <h2 align="right"> <a href="http://geeksquiz.com/">GeeksQuiz</a></h2> 
   <a href="http://www.geeksforgeeks.org/wp-login.php">Login</a> 
         </p></b>  
         
         <div class="clear"></div>         
              
                     
            <div id="menu">   
                 <ul>
 <li><a href="http://www.geeksforgeeks.org">Home</a></li>
  <li><a href="http://www.geeksforgeeks.org/fundamentals-of-algorithms/">Algorithms</a></li>
 <li><a href="http://www.geeksforgeeks.org/data-structures/">DS</a></li>
  <li><a href="http://www.geeksforgeeks.org/gate-corner/">GATE</a></li>
  <li><a href="http://www.geeksforgeeks.org/about/interview-corner/">Interview Corner</a></li>
  <li><a href="http://www.geeksforgeeks.org/forums/">Q&A</a></li>
  <li><a href="http://www.geeksforgeeks.org/c/">C</a></li>
  <li><a href="http://www.geeksforgeeks.org/c-plus-plus/">C++</a></li>
  <li><a href="http://www.geeksforgeeks.org/java/">Java</a></li>
  <li><a href="http://www.geeksforgeeks.org/books/">Books</a></li>
  <li><a href="http://www.geeksforgeeks.org/contribute/">Contribute</a></li>
  <li><a href="http://www.geeksforgeeks.org/contribute/ask-a-question/">Ask a Q</a></li>
  <li><a href="http://www.geeksforgeeks.org/about/">About</a></li>
            </ul>

               
            <div class="clear"></div>     
        </div>
             <div id="navmenu">
				<ul id="menu" style="padding:0; margin:0;">
						<li class="cat-item cat-item-3"><a href="http://www.geeksforgeeks.org/category/c-arrays/" title="Questions regarding Arrays">Array</a>
</li>	

	<li class="cat-item cat-item-17"><a href="http://www.geeksforgeeks.org/category/bit-magic/" title="View all posts filed under Bit Magic">Bit Magic</a>
</li>
	<li class="cat-item cat-item-14"><a href="http://www.geeksforgeeks.org/category/c-puzzles/" title="View all posts filed under C/C++ Puzzles">C/C++</a>
</li>

<li class="cat-item cat-item-18"><a href="http://www.geeksforgeeks.org/category/articles/" title="View all posts filed under Articles">Articles</a>
</li>

	<li class="cat-item cat-item-67"><a href="http://www.geeksforgeeks.org/category/gfact/" title="View all posts filed under GFacts">GFacts</a>
</li>
	<li class="cat-item cat-item-8"><a href="http://www.geeksforgeeks.org/category/linked-list/" title="Linked List problems">Linked List</a>
</li>
	<li class="cat-item cat-item-66"><a href="http://www.geeksforgeeks.org/category/multiple-choice-question/" title="View all posts filed under MCQ">MCQ</a>

</li>
	<li class="cat-item cat-item-4"><a href="http://www.geeksforgeeks.org/category/c-programs/" title="Miscellaneous">Misc</a>
</li>
	<li class="cat-item cat-item-5"><a href="http://www.geeksforgeeks.org/category/program-output/" title="View all posts filed under Output">Output</a>
</li>
	<li class="cat-item cat-item-7"><a href="http://www.geeksforgeeks.org/category/c-strings/" title="Questions related to strings">String</a>
</li>
	<li class="cat-item cat-item-19"><a href="http://www.geeksforgeeks.org/category/tree/" title="View all posts filed under Trees">Tree</a>
</li>
	<li class="cat-item cat-item-19"><a href="http://www.geeksforgeeks.org/category/graph/" title="View all posts filed under Graph">Graph</a>
</li>
</ul>
        </div>
             <div id="content">	   	
	<div class="post" id="post">
							<div class="post-info">			
					<div class="post-title-info">
						<h2 class="post-title">Dynamic Programming | Set 27 (Maximum sum rectangle in a 2D matrix)</h2>
					</div>			
					<div class="clear"></div>				  
				<div class="post-content" id="post-content">
					<p>Given a 2D array, find the maximum sum subarray in it.  For example, in the following 2D array, the maximum sum subarray is highlighted with blue rectangle and sum of this subarray is 29.<span id="more-115029"></span></p>
<p><a href="http://d2o58evtke57tz.cloudfront.net/wp-content/uploads/rectangle.png"><img src="http://d2o58evtke57tz.cloudfront.net/wp-content/uploads/rectangle-11.png" alt="" title="rectangle" width="265" height="233" class="aligncenter size-full wp-image-115043" /></a></p>
<p>This problem is mainly an extension of <a href="http://www.geeksforgeeks.org/largest-sum-contiguous-subarray/" target="_blank">Largest Sum Contiguous Subarray for 1D array</a>. </p>
<p>The <strong>naive solution</strong> for this problem is to check every possible rectangle in given 2D array. This solution requires 4 nested loops and time complexity of this solution would be O(n^4).</p>
<p><strong>Kadane&#8217;s algorithm</strong> for 1D array can be used to reduce the time complexity to O(n^3).  The idea is to fix the left and right columns one by one and find the maximum sum contiguous rows for every left and right column pair. We basically find top and bottom row numbers (which have maximum sum) for every fixed left and right column pair. To find the top and bottom row numbers, calculate sun of elements in every row from left to right and store these sums in an array say temp[].  So temp[i] indicates sum of elements from left to right in row i.  If we apply Kadane&#8217;s 1D algorithm on temp[],  and get the maximum sum subarray of temp, this maximum sum would be the maximum possible sum with left and right as boundary columns.  To get the overall maximum sum, we compare this sum with the maximum sum so far.</p>
<pre class="brush: cpp; highlight: [58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90,91,92,93,94,95,96,97,98,99,100,101,102,103]; title: ; notranslate" title="">
// Program to find maximum sum subarray in a given 2D array
#include &lt;stdio.h&gt;
#include &lt;string.h&gt;
#include &lt;limits.h&gt;
#define ROW 4
#define COL 5

// Implementation of Kadane's algorithm for 1D array. The function returns the
// maximum sum and stores starting and ending indexes of the maximum sum subarray
// at addresses pointed by start and finish pointers respectively.
int kadane(int* arr, int* start, int* finish, int n)
{
    // initialize sum, maxSum and
    int sum = 0, maxSum = INT_MIN, i;

    // Just some initial value to check for all negative values case
    *finish = -1;

    // local variable
    int local_start = 0;

    for (i = 0; i &lt; n; ++i)
    {
        sum += arr[i];
        if (sum &lt; 0)
        {
            sum = 0;
            local_start = i+1;
        }
        else if (sum &gt; maxSum)
        {
            maxSum = sum;
            *start = local_start;
            *finish = i;
        }
    }

     // There is at-least one non-negative number
    if (*finish != -1)
        return maxSum;

    // Special Case: When all numbers in arr[] are negative
    maxSum = arr[0];
    *start = *finish = 0;

    // Find the maximum element in array
    for (i = 1; i &lt; n; i++)
    {
        if (arr[i] &gt; maxSum)
        {
            maxSum = arr[i];
            *start = *finish = i;
        }
    }
    return maxSum;
}

// The main function that finds maximum sum rectangle in M[][]
void findMaxSum(int M[][COL])
{
    // Variables to store the final output
    int maxSum = INT_MIN, finalLeft, finalRight, finalTop, finalBottom;

    int left, right, i;
    int temp[ROW], sum, start, finish;

    // Set the left column
    for (left = 0; left &lt; COL; ++left)
    {
        // Initialize all elements of temp as 0
        memset(temp, 0, sizeof(temp));

        // Set the right column for the left column set by outer loop
        for (right = left; right &lt; COL; ++right)
        {
            // Calculate sum between current left and right for every row 'i'
            for (i = 0; i &lt; ROW; ++i)
                temp[i] += M[i][right];

            // Find the maximum sum subarray in temp[]. The kadane() function
            // also sets values of start and finish.  So 'sum' is sum of
            // rectangle between (start, left) and (finish, right) which is the
            //  maximum sum with boundary columns strictly as left and right.
            sum = kadane(temp, &amp;start, &amp;finish, ROW);

            // Compare sum with maximum sum so far. If sum is more, then update
            // maxSum and other output values
            if (sum &gt; maxSum)
            {
                maxSum = sum;
                finalLeft = left;
                finalRight = right;
                finalTop = start;
                finalBottom = finish;
            }
        }
    }

    // Print final values
    printf(&quot;(Top, Left) (%d, %d)\n&quot;, finalTop, finalLeft);
    printf(&quot;(Bottom, Right) (%d, %d)\n&quot;, finalBottom, finalRight);
    printf(&quot;Max sum is: %d\n&quot;, maxSum);
}

// Driver program to test above functions
int main()
{
    int M[ROW][COL] = {{1, 2, -1, -4, -20},
                       {-8, -3, 4, 2, 1},
                       {3, 8, 10, 1, 3},
                       {-4, -1, 1, 7, -6}
                      };

    findMaxSum(M);

    return 0;
}
</pre>
<p>Output:
<pre>(Top, Left) (1, 1)
(Bottom, Right) (3, 3)
Max sum is: 29</pre>
<p>Time Complexity: O(n^3)</p>
<p>This article is compiled by<a href="https://www.facebook.com/barnwal.aashish?fref=ts"> Aashish Barnwal</a>. Please write comments if you find anything incorrect, or you want to share more information about the topic discussed above.</p>
		
&nbsp;
&nbsp;
<script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
<!-- Big Rectangle Blog Bottom -->
<ins class="adsbygoogle"
     style="display:inline-block;width:336px;height:280px"
     data-ad-client="ca-pub-9465609616171866"
     data-ad-slot="4061219431"></ins>
<script>
(adsbygoogle = window.adsbygoogle || []).push({});
</script>



&nbsp;
&nbsp;
&nbsp;
<h3>Related Topics:</h3><ul><li><a href="http://www.geeksforgeeks.org/kth-smallestlargest-element-unsorted-array-set-2-expected-linear-time/" title="K’th Smallest/Largest Element in Unsorted Array | Set 2 (Expected Linear Time)">K’th Smallest/Largest Element in Unsorted Array | Set 2 (Expected Linear Time)</a></li><li><a href="http://www.geeksforgeeks.org/kth-smallestlargest-element-unsorted-array/" title="K&#8217;th Smallest/Largest Element in Unsorted Array | Set 1">K&#8217;th Smallest/Largest Element in Unsorted Array | Set 1</a></li><li><a href="http://www.geeksforgeeks.org/time-complexity-insertion-sort-inversions/" title="Time complexity of insertion sort when there are O(n) inversions?">Time complexity of insertion sort when there are O(n) inversions?</a></li><li><a href="http://www.geeksforgeeks.org/check-two-given-sets-disjoint/" title="How to check if two given sets are disjoint?">How to check if two given sets are disjoint?</a></li><li><a href="http://www.geeksforgeeks.org/minimum-number-platforms-required-railwaybus-station/" title="Minimum Number of Platforms Required for a Railway/Bus Station">Minimum Number of Platforms Required for a Railway/Bus Station</a></li><li><a href="http://www.geeksforgeeks.org/given-two-sorted-arrays-number-x-find-pair-whose-sum-closest-x/" title="Find the closest pair from two sorted arrays">Find the closest pair from two sorted arrays</a></li><li><a href="http://www.geeksforgeeks.org/print-elements-sorted-order-row-column-wise-sorted-matrix/" title="Print all elements in sorted order from row and column wise sorted matrix">Print all elements in sorted order from row and column wise sorted matrix</a></li><li><a href="http://www.geeksforgeeks.org/length-largest-subarray-contiguous-elements-set-1/" title="Length of the largest subarray with contiguous elements | Set 1">Length of the largest subarray with contiguous elements | Set 1</a></li></ul>
<p>Tags: <a href="http://www.geeksforgeeks.org/tag/dynamic-programming/" rel="tag">Dynamic Programming</a></p> 
<div>
<iframe src="http://www.facebook.com/plugins/like.php?href=http%3A%2F%2Fwww.geeksforgeeks.org%2Fdynamic-programming-set-27-max-sum-rectangle-in-a-2d-matrix%2F&layout=button_count&show_faces=false&width=90&action=like&colorscheme=light" scrolling="no" frameborder="0" allowTransparency="true" style="border:none; overflow:hidden; width:90px; height:20px"></iframe>
<a href="http://twitter.com/share" class="twitter-share-button" data-url="http://www.geeksforgeeks.org/dynamic-programming-set-27-max-sum-rectangle-in-a-2d-matrix/" data-text="Dynamic Programming | Set 27 (Maximum sum rectangle in a 2D matrix)" data-count="horizontal" data-via="jakerutter">Tweet</a><script type="text/javascript" src="http://platform.twitter.com/widgets.js"></script>
<g:plusone size="medium" href="http://www.geeksforgeeks.org/dynamic-programming-set-27-max-sum-rectangle-in-a-2d-matrix/"></g:plusone>
<!-- Place this render call where appropriate -->
<script type="text/javascript">
  (function() {
    var po = document.createElement('script'); po.type = 'text/javascript'; po.async = true;
    po.src = 'https://apis.google.com/js/plusone.js';
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(po, s);
  })();
</script></div>





				</div>		  
			</div> <!-- end post main -->					
			<div class="post-meta">
				<div class="left"></div>				
				<div class="clear"></div>
			</div>			
        
			<div class="comments-main">		
 <b>Writing code in comment?</b> Please use <b><a href="http://ideone.com/">ideone.com</a></b> and share the link here.
				
<div id="disqus_thread">
            <div id="dsq-content">


            <ul id="dsq-comments">
                    <li class="comment even thread-even depth-1" id="dsq-comment-34422">
        <div id="dsq-comment-header-34422" class="dsq-comment-header">
            <cite id="dsq-cite-34422">
                <span id="dsq-author-user-34422">Whatever</span>
            </cite>
        </div>
        <div id="dsq-comment-body-34422" class="dsq-comment-body">
            <div id="dsq-comment-message-34422" class="dsq-comment-message"><p>Time Complexity is precisely O( Col^2 * Row )  !!</p>
</div>
        </div>

    </li><!-- #comment-## -->
    <li class="comment odd alt thread-odd thread-alt depth-1" id="dsq-comment-34421">
        <div id="dsq-comment-header-34421" class="dsq-comment-header">
            <cite id="dsq-cite-34421">
                <span id="dsq-author-user-34421">Guest</span>
            </cite>
        </div>
        <div id="dsq-comment-body-34421" class="dsq-comment-body">
            <div id="dsq-comment-message-34421" class="dsq-comment-message"><p>Time Complexity is precisely O( Col^2 * Row )  <img src="http://d2o58evtke57tz.cloudfront.net/wp-includes/images/smilies/icon_smile.gif" alt=":)" class="wp-smiley" /></p>
</div>
        </div>

    </li><!-- #comment-## -->
    <li class="comment even thread-even depth-1" id="dsq-comment-33166">
        <div id="dsq-comment-header-33166" class="dsq-comment-header">
            <cite id="dsq-cite-33166">
                <span id="dsq-author-user-33166">Guest</span>
            </cite>
        </div>
        <div id="dsq-comment-body-33166" class="dsq-comment-body">
            <div id="dsq-comment-message-33166" class="dsq-comment-message"><p>Hi, there is an O(n^2) algorithm for this using O(n^2) extra space.</p>
<p>Input :- given matrix a[][] of dimension m*n.</p>
<p>Algo:-</p>
<p>1) create a new matrix n[][] of dimension m*n.</p>
<p>2) n[i][j] =  for k = 0 to i (sum of a[k][j] ). That is the new matrix is the column wise sum matrix.</p>
<p>3) Now apply the well known standard &#8220;Max rectangle in histogram&#8221; algorithm on each row of the n[][].<br />
<a href="http://www.geeksforgeeks.org/largest-rectangle-under-histogram/" rel="nofollow">http://www.geeksforgeeks.org/largest-rectangle-under-histogram/</a></p>
<p>             a) Compare the curr_max with max.</p>
<p>return max.</p>
<p>Time complexity &#8211; O(n^2).</p>
</div>
        </div>

    <ul class="children">
    <li class="comment odd alt depth-2" id="dsq-comment-33344">
        <div id="dsq-comment-header-33344" class="dsq-comment-header">
            <cite id="dsq-cite-33344">
                <span id="dsq-author-user-33344">jafar</span>
            </cite>
        </div>
        <div id="dsq-comment-body-33344" class="dsq-comment-body">
            <div id="dsq-comment-message-33344" class="dsq-comment-message"><p>I don&#8217;t see how that will give us the desired result.since applying the max rectangle might use &#8216;a fraction of a slot&#8217; e.g: using 3 out of a slot with value 4.or using different sets of rows for each column,thus not producing a rectangle.</p>
</div>
        </div>

    </li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
    <li class="comment even thread-odd thread-alt depth-1" id="dsq-comment-31990">
        <div id="dsq-comment-header-31990" class="dsq-comment-header">
            <cite id="dsq-cite-31990">
                <span id="dsq-author-user-31990">Aditya</span>
            </cite>
        </div>
        <div id="dsq-comment-body-31990" class="dsq-comment-body">
            <div id="dsq-comment-message-31990" class="dsq-comment-message"><p>This will not work for matrix<br />
{ {-1,-1,-1},<br />
   {9, 9, -1},<br />
  {-1,-1,-1}}.<br />
It will give result as 17 but the answer should be 18.</p>
</div>
        </div>

    <ul class="children">
    <li class="comment odd alt depth-2" id="dsq-comment-32182">
        <div id="dsq-comment-header-32182" class="dsq-comment-header">
            <cite id="dsq-cite-32182">
                <span id="dsq-author-user-32182">meh</span>
            </cite>
        </div>
        <div id="dsq-comment-body-32182" class="dsq-comment-body">
            <div id="dsq-comment-message-32182" class="dsq-comment-message"><p>It works, I tried the code and it returns 18.</p>
</div>
        </div>

    </li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
    <li class="comment even thread-even depth-1" id="dsq-comment-31942">
        <div id="dsq-comment-header-31942" class="dsq-comment-header">
            <cite id="dsq-cite-31942">
                <span id="dsq-author-user-31942">Mythreya J L</span>
            </cite>
        </div>
        <div id="dsq-comment-body-31942" class="dsq-comment-body">
            <div id="dsq-comment-message-31942" class="dsq-comment-message"><p>Can be reduced to O(n^2). </p>
<p>1. Find integral &#8220;image&#8221; representation of the matrix: O(n^2)<br />
2. Find the position of the maximum element, (x1,y1) in the integral image: O(n^2) </p>
<p>3. Find the position of the minimum element, (x0,y0) that appears strictly before the maximum element found, which means it has to be at a lower row AND lower column: O(n^2).</p>
<p>Maximum subarray is (x0:x1, y0:y1), time complexity: O(n^2)+O(n^2)+O(n^2) = O(n^2)</p>
</div>
        </div>

    <ul class="children">
    <li class="comment odd alt depth-2" id="dsq-comment-32004">
        <div id="dsq-comment-header-32004" class="dsq-comment-header">
            <cite id="dsq-cite-32004">
                <span id="dsq-author-user-32004">jerrym</span>
            </cite>
        </div>
        <div id="dsq-comment-body-32004" class="dsq-comment-body">
            <div id="dsq-comment-message-32004" class="dsq-comment-message"><p>Unfortunately, there is no guarantee that the maximum element in the integral image is also the last element of the maximum subarray.</p>
</div>
        </div>

    </li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
    <li class="comment even thread-odd thread-alt depth-1" id="dsq-comment-30987">
        <div id="dsq-comment-header-30987" class="dsq-comment-header">
            <cite id="dsq-cite-30987">
                <span id="dsq-author-user-30987">Sumit Khanna</span>
            </cite>
        </div>
        <div id="dsq-comment-body-30987" class="dsq-comment-body">
            <div id="dsq-comment-message-30987" class="dsq-comment-message"><p>Hey!&#8230;time complexity for BRUTE FORCE or NAIVE is O(n^6) and not O(n^4)&#8230;.you fix all N^2 toplefts and ~ N^2 bottomRights for every topleft,,and N^2 for calculating sum of every considered rectangle of the N^4 possible rectangles,,,thus total time is O(n^6) &#8230;</p>
</div>
        </div>

    </li><!-- #comment-## -->
    <li class="comment odd alt thread-even depth-1" id="dsq-comment-28507">
        <div id="dsq-comment-header-28507" class="dsq-comment-header">
            <cite id="dsq-cite-28507">
                <span id="dsq-author-user-28507">intdydx</span>
            </cite>
        </div>
        <div id="dsq-comment-body-28507" class="dsq-comment-body">
            <div id="dsq-comment-message-28507" class="dsq-comment-message"><p>I implemented an FFT-based solution here:<br />
<a href="https://github.com/thearn/maximum-submatrix-sum" rel="nofollow">https://github.com/thearn/maximum-submatrix-sum</a></p>
</div>
        </div>

    </li><!-- #comment-## -->
</li><!-- #comment-## -->
</li><!-- #comment-## -->
</li><!-- #comment-## -->
</li><!-- #comment-## -->
    <li class="comment byuser comment-author-fenglvming even thread-odd thread-alt depth-1" id="dsq-comment-21837">
        <div id="dsq-comment-header-21837" class="dsq-comment-header">
            <cite id="dsq-cite-21837">
                <span id="dsq-author-user-21837">fenglvming</span>
            </cite>
        </div>
        <div id="dsq-comment-body-21837" class="dsq-comment-body">
            <div id="dsq-comment-message-21837" class="dsq-comment-message"><pre> <code language="C">
/* Paste your code here (You may delete these lines if not writing code) */
for (left = 0; left &lt; COL; ++left)
    {
        // Initialize all elements of temp as 0
        memset(temp, 0, sizeof(temp));
 
        // Set the right column for the left column set by outer loop
        for (right = left; right &lt; COL; ++right)
        {
            // Calculate sum between current left and right for every row 'i'
            for (i = 0; i &lt; ROW; ++i)
                temp[i] += M[i][right];
 
            // Find the maximum sum subarray in temp[]. The kadane() function
            // also sets values of start and finish.  So 'sum' is sum of
            // rectangle between (start, left) and (finish, right) which is the
            //  maximum sum with boundary columns strictly as left and right.
            sum = kadane(temp, &amp;start, &amp;finish, ROW);
 
            // Compare sum with maximum sum so far. If sum is more, then update
            // maxSum and other output values
            if (sum &gt; maxSum)
            {
                maxSum = sum;
                finalLeft = left;
                finalRight = right;
                finalTop = start;
                finalBottom = finish;
            }
        }
    }



</code> </pre>
<p>I&#8217;m sorry, I&#8217;m confused about this code.<br />
The code below maybe wrong.<br />
It&#8217;s repeatedly sum the M[i][right]</p>
<p>for (i = 0; i &lt; ROW; ++i)<br />
                temp[i] += M[i][right];</p>
</div>
        </div>

    </li><!-- #comment-## -->
    <li class="comment odd alt thread-even depth-1" id="dsq-comment-21729">
        <div id="dsq-comment-header-21729" class="dsq-comment-header">
            <cite id="dsq-cite-21729">
                <span id="dsq-author-user-21729">Born Actor</span>
            </cite>
        </div>
        <div id="dsq-comment-body-21729" class="dsq-comment-body">
            <div id="dsq-comment-message-21729" class="dsq-comment-message"><pre> <code language="C">
#include &lt;iostream&gt;
#include&lt;string&gt;
#include&lt;sstream&gt;
#include&lt;iomanip&gt;
# include &lt;stdio.h&gt;
# include &lt;math.h&gt;
#include &lt;vector&gt;
#include &lt;stdlib.h&gt;
using namespace std;
int n_r;
int n_c;
int n;
int a[50];
pair &lt; int , pair &lt; int , int &gt; &gt; function(int i, int j);
 pair &lt; int , pair &lt; pair &lt; int,  int &gt; , pair &lt; int ,int &gt; &gt; &gt; answer; 
pair &lt; int , pair &lt; int , int &gt; &gt; function2(int i, int m, int j);
pair &lt; int , pair &lt; int , int &gt; &gt; max(pair &lt; int , pair &lt; int , int &gt;  &gt; a,pair &lt; int , pair &lt; int , int &gt;  &gt; b ,pair &lt; int , pair &lt; int , int &gt;  &gt; c);
int b[50][50];
int main()
{
	 int i,j;
	 cout&lt;&lt;&quot;etner the row size of the arraay&quot;;
	 cin&gt;&gt;n_r;
	 n=n_r;
	 cout&lt;&lt;&quot;enter the column size of the array&quot;;
	 cin&gt;&gt;n_c;
	 answer.first=-99999;
	 for(i=0;i&lt;n_r;i++)
		 for(j=0;j&lt;n_c;j++)
	 cin&gt;&gt;b[i][j];
	 for(i=0;i&lt;n;i++)
		 a[i]=0;
	  pair &lt; int , pair &lt; int , int &gt; &gt; ans_temp;
	 for(i=0;i&lt;n_c;i++)
	 {
		 for(int t=0;t&lt;n;t++)
			 a[t]=0;
	 	for(j=i;j&lt;n_c;j++)
		{
			for(int k=0;k&lt;n;k++)
			{
				a[k]=a[k]+b[k][j];
			}
				ans_temp=function(0,n-1);
				if(ans_temp.first&gt;answer.first)
				{
					answer.first=ans_temp.first;
					answer.second.first.first=ans_temp.second.first;
					answer.second.first.second=ans_temp.second.second;
					answer.second.second.first=i;
					answer.second.second.second=j;
				}

					
		}
		cout&lt;&lt;endl&lt;&lt;answer.first&lt;&lt;&quot;  &quot;&lt;&lt;answer.second.first.first&lt;&lt;&quot;  &quot;&lt;&lt;answer.second.first.second&lt;&lt;&quot;  &quot;&lt;&lt;answer.second.second.first&lt;&lt;&quot;  &quot;&lt;&lt;answer.second.first.second&lt;&lt;&quot;  &quot;&lt;&lt;endl;
	 }
	cout&lt;&lt;endl&lt;&lt;answer.first&lt;&lt;&quot;  &quot;&lt;&lt;answer.second.first.first&lt;&lt;&quot;  &quot;&lt;&lt;answer.second.first.second&lt;&lt;&quot;  &quot;&lt;&lt;answer.second.second.first&lt;&lt;&quot;  &quot;&lt;&lt;answer.second.first.second&lt;&lt;&quot;  &quot;&lt;&lt;endl;
}
pair &lt; int , pair &lt; int ,int &gt; &gt;function(int l, int r)
{
	//base case
	if(l==r)
		return make_pair (a[l] , make_pair (l,l ) );
	if(r==l+1)
	{
		if(a[r]&gt;0 &amp;&amp; a[l]&gt;0)
			return make_pair (a[l]+a[r] , make_pair (l,r ) );
		if(a[r]==0 &amp;&amp; a[l]&gt;0)
			return make_pair (a[l] , make_pair (l,l ) );
		if(a[r]&lt;0 &amp;&amp; a[l]&gt;0)
			return make_pair (a[l] , make_pair (l,l ) );
		if(a[r]&gt;0 &amp;&amp; a[l]&lt;0)
			return make_pair (a[r] , make_pair (r,r ) );
		if(a[r]==0 &amp;&amp; a[l]&lt;0)
			return make_pair (a[r] , make_pair (r,r ) );
		if(a[r]&lt;0 &amp;&amp; a[l]&lt;0 &amp;&amp; a[r] &gt; a[l])
			return make_pair (a[r] , make_pair (r,r ) );
		if(a[r]&lt;0 &amp;&amp; a[l]&lt;0 &amp;&amp; a[r]&lt;a[l])
			return make_pair (a[l] , make_pair (l,l ) );
		if(a[r]&gt;0 &amp;&amp; a[l]==0)
			return make_pair (a[r] , make_pair (r,r ) );
		if(a[r]==0 &amp;&amp; a[l]==0)
			return make_pair (a[l] , make_pair (l,l ) );
		if(a[r]&lt;0 &amp;&amp; a[l]==0)
			return make_pair (a[l] , make_pair (l,l ) );
	}

	int m =( l+r)/2;
	pair &lt; int , pair &lt; int , int &gt;  &gt; temp;
		
	pair &lt; int , pair &lt; int , int &gt;  &gt; temp1;

	pair &lt; int , pair &lt; int , int &gt;  &gt; temp2;
	pair &lt; int , pair &lt; int , int &gt;  &gt; temp3;
	temp1= function(l,m);
	temp2=function(m,r);
	temp3=function2(l,m,r);
	temp= max(temp1,temp2,temp3);
	return temp;


}
pair &lt; int , pair &lt; int ,int &gt; &gt; function2(int l ,int m, int r )
{
	//base case;
	pair &lt; int , pair &lt; int , int &gt;  &gt; temp;
	int max_l=-9999;
	int sum_l=0;
	int max_r=-9999;
	int sum_r=0;
	int right=m;
	int left=m;
	int temp2=0;
	int i,j;
	for(i=m;i&lt;=r;i++)
	{
		sum_r=sum_r+a[i];
		if(sum_r&gt;max_r)
		{
			max_r=sum_r;
			right = i;	
		}
	}
	for(i=m-1;i&gt;=l;i--)
	{
		sum_l=sum_l+a[i];
		if(sum_l&gt;max_l)
		{
			max_l=sum_l;
			left = i;	
		}
	}
	return make_pair( (max_r+max_l) , make_pair(left,right));
}
pair &lt; int , pair &lt; int , int &gt;  &gt; max (pair &lt; int , pair &lt; int , int &gt;  &gt; a , pair &lt; int , pair &lt; int , int &gt;  &gt; b,   pair &lt; int , pair &lt; int , int &gt;  &gt; c)
{
	pair &lt; int , pair &lt; int , int &gt;  &gt; max1;
	max1 = a;
	if(b.first&gt;max1.first)
		max1=b;
	if(c.first&gt;max1.first)
		max1=c;
	return max1;
}
</code> </pre>
</div>
        </div>

    </li><!-- #comment-## -->
</li><!-- #comment-## -->
    <li class="comment even thread-odd thread-alt depth-1" id="dsq-comment-20183">
        <div id="dsq-comment-header-20183" class="dsq-comment-header">
            <cite id="dsq-cite-20183">
                <span id="dsq-author-user-20183">logic_bomber</span>
            </cite>
        </div>
        <div id="dsq-comment-body-20183" class="dsq-comment-body">
            <div id="dsq-comment-message-20183" class="dsq-comment-message"><p>Why is it under &#8216;Dynamic Programming&#8217;? Do help me understand what property of Dynamic Programming comes here.</p>
</div>
        </div>

    </li><!-- #comment-## -->
<ul class="children">
    <li class="comment odd alt depth-2" id="dsq-comment-29859">
        <div id="dsq-comment-header-29859" class="dsq-comment-header">
            <cite id="dsq-cite-29859">
                <span id="dsq-author-user-29859">Chaitanya T V Krishna</span>
            </cite>
        </div>
        <div id="dsq-comment-body-29859" class="dsq-comment-body">
            <div id="dsq-comment-message-29859" class="dsq-comment-message"><p>We do not escape n2 complexity in column. But we use Kandane&#8217;s algorithm during computing maximum sum contiguous rows to convert n2 to n.</p>
</div>
        </div>

    </li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</li><!-- #comment-## -->
</li><!-- #comment-## -->
    <li class="comment even thread-even depth-1" id="dsq-comment-19698">
        <div id="dsq-comment-header-19698" class="dsq-comment-header">
            <cite id="dsq-cite-19698">
                <span id="dsq-author-user-19698">Paparao Veeragandham</span>
            </cite>
        </div>
        <div id="dsq-comment-body-19698" class="dsq-comment-body">
            <div id="dsq-comment-message-19698" class="dsq-comment-message"><pre> <code language="C">
Given a matrix of both +ve and -ve numbers, find out the maximum sum sub matrix. First of all we will calculate the sum matrix where s[i][j] = sum of all the elements from [0,0] to [i,j] 

int s[ROW][COL];
 void computeSumMatrix(int a[][COL], int r, int c) {
  for (int i = 0; i &lt; r; i++)
   if (i == 0)
    s[i][0] = a[i][0];
   else
    s[i][0] = s[i - 1][0] + a[i][0];
 
  for (int j = 0; j &lt; c; j++)
   if (j == 0)
    s[0][j] = a[0][j];
   else
    s[0][j] = s[0][j - 1] + a[0][j];
 
  for (int i = 1; i &lt; r; i++) {
   for (int j = 1; j &lt; c; j++) {
    s[i][j] = a[i][j] + s[i - 1][j] + s[i][j - 1] - s[i - 1][j - 1];
   }
  }


Now we will write a method to get the sum of a sub matrix given upper-left (r1,c1) indexes and lower-bottom (r2,c2) indexes 

int getSubmatSum(int r1, int c1, int r2, int c2) {
  if (r1 == 0 &amp;&amp; c1 == 0)
   return s[r2][c2];
  if (r1 == 0)
   return s[r2][c2] - s[r2][c1 - 1];
  if (c1 == 0)
   return s[r2][c2] - s[r1 - 1][c2];
  return s[r2][c2] - s[r1 - 1][c2] - s[r2][c1 - 1] + s[r1 - 1][c1 - 1];
 }


Using both these methods, we can iterate through all the possible sub matrices and get their sum in O(1). To iterate though all the possible sub-matrices would take O(n^4). 


int getMaxSubmatSum(int a[][COL], int r, int c) {
  int maxsum = 0;
  for (int r1 = 0; r1 &lt; r; r1++) {
   for (int c1 = 0; c1 &lt; c; c1++) {
    for (int r2 = r1; r2 &lt; r; r2++) {
     for (int c2 = c1; c2 &lt; c; c2++) {
      int sum = getSubmatSum(r1, c1, r2, c2);
      maxsum = max(sum, maxsum);
     }
    }
   }
  }
  return maxsum;
 }


Now, we are going to optimize this solution to O(n^3). The trick is to apply Kadane's algorithm on a 2D matrix. We will consider all the possible 2D matrices which are starting from 0th column and treat them as 1D arrays. 

int getMaxSubmatSum2(int a[][COL], int r, int c) {
  int globalmax = 0;
 
  for (int i = 0; i &lt; r; i++)
   for (int j = i; j &lt; r; j++) {
    int localmax = 0;
    for (int k = 0; k &lt; c; k++) {
     localmax = max(localmax + getSubmatSum(i, k, j, k), 0);
     globalmax = max(localmax, globalmax);
    }
   }
 
  return globalmax;
 }

Source is : http://geekmeal.blogspot.in/2013/02/syntaxhighlighter.html
</code> </pre>
</div>
        </div>

    </li><!-- #comment-## -->
    <li class="comment odd alt thread-odd thread-alt depth-1" id="dsq-comment-18347">
        <div id="dsq-comment-header-18347" class="dsq-comment-header">
            <cite id="dsq-cite-18347">
                <span id="dsq-author-user-18347">rkl</span>
            </cite>
        </div>
        <div id="dsq-comment-body-18347" class="dsq-comment-body">
            <div id="dsq-comment-message-18347" class="dsq-comment-message"><p>The lines</p>
<pre> <code language="C">
// Calculate sum between current left and right for every row 'i'
       for (i = 0; i &lt; ROW; ++i)
           temp[i] += M[i][right];
</code> </pre>
<p>is wrong.</p>
<p>We should calculate temp[i] = M[i][left] + &#8230; + M[i][right]<br />
which should be done in a loop.</p>
<pre> <code language="C">
       for (i = 0; i &lt; ROW; ++i)
           for(int j = left; j &lt;=right; j++)
               temp[i] += M[i][j];
</code> </pre>
</div>
        </div>

    <ul class="children">
    <li class="comment even depth-2" id="dsq-comment-18348">
        <div id="dsq-comment-header-18348" class="dsq-comment-header">
            <cite id="dsq-cite-18348">
                <span id="dsq-author-user-18348">rkl</span>
            </cite>
        </div>
        <div id="dsq-comment-body-18348" class="dsq-comment-body">
            <div id="dsq-comment-message-18348" class="dsq-comment-message"><p>I think I got the point. Please ignore my previous comment.<br />
In the first iteration when right=left, there is only 1 column in temp per i.<br />
temp[i] = 0 (temp is initialized to 0) + M[i][right or left, its same in first iteration]</p>
<p>In 2nd iteration, when right=left+1,<br />
temp[i] = old_temp[i] (which is M[i][left]) + M[i][right]</p>
</div>
        </div>

    </li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
    <li class="comment byuser comment-author-abhishek08aug odd alt thread-even depth-1" id="dsq-comment-17767">
        <div id="dsq-comment-header-17767" class="dsq-comment-header">
            <cite id="dsq-cite-17767">
                <span id="dsq-author-user-17767">abhishek08aug</span>
            </cite>
        </div>
        <div id="dsq-comment-body-17767" class="dsq-comment-body">
            <div id="dsq-comment-message-17767" class="dsq-comment-message"><p>Intelligent <img src="http://d2o58evtke57tz.cloudfront.net/wp-includes/images/smilies/icon_biggrin.gif" alt=":D" class="wp-smiley" /></p>
<pre> <code language="C">
/* Paste your code here (You may delete these lines if not writing code) */
</code> </pre>
</div>
        </div>

    </li><!-- #comment-## -->
    <li class="comment even thread-odd thread-alt depth-1" id="dsq-comment-17686">
        <div id="dsq-comment-header-17686" class="dsq-comment-header">
            <cite id="dsq-cite-17686">
                <span id="dsq-author-user-17686">chitra</span>
            </cite>
        </div>
        <div id="dsq-comment-body-17686" class="dsq-comment-body">
            <div id="dsq-comment-message-17686" class="dsq-comment-message"><pre> <code language="C">
/* Paste your code here (You may delete these lines if not writing code) */
</code> </pre>
</div>
        </div>

    </li><!-- #comment-## -->
    <li class="comment odd alt thread-even depth-1" id="dsq-comment-17137">
        <div id="dsq-comment-header-17137" class="dsq-comment-header">
            <cite id="dsq-cite-17137">
                <span id="dsq-author-user-17137">sk</span>
            </cite>
        </div>
        <div id="dsq-comment-body-17137" class="dsq-comment-body">
            <div id="dsq-comment-message-17137" class="dsq-comment-message"><p>Your kadance method wont work to find start and finish index when given 2d matrix contains only negative integers.</p>
<p>So given solution will be wrong.</p>
</div>
        </div>

    </li><!-- #comment-## -->
</li><!-- #comment-## -->
    <li class="comment even thread-odd thread-alt depth-1" id="dsq-comment-16486">
        <div id="dsq-comment-header-16486" class="dsq-comment-header">
            <cite id="dsq-cite-16486">
                <span id="dsq-author-user-16486">Kashish Babbar</span>
            </cite>
        </div>
        <div id="dsq-comment-body-16486" class="dsq-comment-body">
            <div id="dsq-comment-message-16486" class="dsq-comment-message"><p>How is the naive solution O(n^4) ?<br />
Shouldn&#8217;t it be O(n^6) if we are checking all the possible rectangles ?<br />
O(n^2) for choosing the start point and O(n^2) for choosing the end point i.e. 4 loops and then to calculate the sum another two for loops ?</p>
</div>
        </div>

    <ul class="children">
    <li class="comment odd alt depth-2" id="dsq-comment-24482">
        <div id="dsq-comment-header-24482" class="dsq-comment-header">
            <cite id="dsq-cite-24482">
                <span id="dsq-author-user-24482">Prateek Caire</span>
            </cite>
        </div>
        <div id="dsq-comment-body-24482" class="dsq-comment-body">
            <div id="dsq-comment-message-24482" class="dsq-comment-message"><p>Even i think same. GFG needs to correct..</p>
<pre> <code language="C">
/* Paste your code here (You may delete these lines if not writing code) */
</code> </pre>
</div>
        </div>

    </li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
    <li class="comment byuser comment-author-curieuxtoujours even thread-even depth-1" id="dsq-comment-16164">
        <div id="dsq-comment-header-16164" class="dsq-comment-header">
            <cite id="dsq-cite-16164">
                <span id="dsq-author-user-16164">curieuxtoujours</span>
            </cite>
        </div>
        <div id="dsq-comment-body-16164" class="dsq-comment-body">
            <div id="dsq-comment-message-16164" class="dsq-comment-message"><p>there is a O(n^2) solution with O(n^2) space complexity.</p>
</div>
        </div>

    <ul class="children">
    <li class="comment byuser comment-author-curieuxtoujours odd alt depth-2" id="dsq-comment-16166">
        <div id="dsq-comment-header-16166" class="dsq-comment-header">
            <cite id="dsq-cite-16166">
                <span id="dsq-author-user-16166">curieuxtoujours</span>
            </cite>
        </div>
        <div id="dsq-comment-body-16166" class="dsq-comment-body">
            <div id="dsq-comment-message-16166" class="dsq-comment-message"><p>Algo :<br />
1. Create another matrix of the same size mat[R][C].<br />
2. Fill the mat[R][C] such that mat[i][j] contains the sum of the matrix M from [0,0] to [i,j]. Complexity n^2. something similar to kadane&#8217;s algo.<br />
3. Now run two loops for i and j .. like the above post , but now you don&#8217;t need to find the sum in O(n) time as you can find it from previously constructed mat in constant time. How ?</p>
</div>
        </div>

    <ul class="children">
    <li class="comment byuser comment-author-cdegree even depth-3" id="dsq-comment-16390">
        <div id="dsq-comment-header-16390" class="dsq-comment-header">
            <cite id="dsq-cite-16390">
                <span id="dsq-author-user-16390">cdegree</span>
            </cite>
        </div>
        <div id="dsq-comment-body-16390" class="dsq-comment-body">
            <div id="dsq-comment-message-16390" class="dsq-comment-message"><p>for start position, you need n^2;<br />
and for end position, you also need n^2.<br />
so is that n^4?</p>
</div>
        </div>

    <ul class="children">
    <li class="comment byuser comment-author-cdegree odd alt depth-4" id="dsq-comment-16391">
        <div id="dsq-comment-header-16391" class="dsq-comment-header">
            <cite id="dsq-cite-16391">
                <span id="dsq-author-user-16391">cdegree</span>
            </cite>
        </div>
        <div id="dsq-comment-body-16391" class="dsq-comment-body">
            <div id="dsq-comment-message-16391" class="dsq-comment-message"><p>I mean O(n^2) time<br />
       O(n^2) time<br />
and    O(n^4) time</p>
</div>
        </div>

    </li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
    <li class="comment even thread-odd thread-alt depth-1" id="dsq-comment-16163">
        <div id="dsq-comment-header-16163" class="dsq-comment-header">
            <cite id="dsq-cite-16163">
                <span id="dsq-author-user-16163">Arvind B R</span>
            </cite>
        </div>
        <div id="dsq-comment-body-16163" class="dsq-comment-body">
            <div id="dsq-comment-message-16163" class="dsq-comment-message"><p>this part is wrong ,start will be updated even though if the start is not a part of maximum sum </p>
<pre> <code language="C"> 

for (i = 0; i &lt; n; ++i)
    {
        sum += arr[i];
        if (sum &lt; 0)
        {
            sum = 0;
            *start = i+1;
        }
        else if (sum &gt; maxSum)
        {
            maxSum = sum;
            *finish = i;
        }
    }
</code> </pre>
</div>
        </div>

    <ul class="children">
    <li class="comment odd alt depth-2" id="dsq-comment-16180">
        <div id="dsq-comment-header-16180" class="dsq-comment-header">
            <cite id="dsq-cite-16180">
                <span id="dsq-author-user-16180">Sah39</span>
            </cite>
        </div>
        <div id="dsq-comment-body-16180" class="dsq-comment-body">
            <div id="dsq-comment-message-16180" class="dsq-comment-message"><p>hai da BR&#8230;.</p>
<pre> <code language="C">
/* Paste your code here (You may delete these lines if not writing code) */
</code> </pre>
</div>
        </div>

    </li><!-- #comment-## -->
    <li class="comment byuser comment-author-cdegree even depth-2" id="dsq-comment-16389">
        <div id="dsq-comment-header-16389" class="dsq-comment-header">
            <cite id="dsq-cite-16389">
                <span id="dsq-author-user-16389">cdegree</span>
            </cite>
        </div>
        <div id="dsq-comment-body-16389" class="dsq-comment-body">
            <div id="dsq-comment-message-16389" class="dsq-comment-message"><pre> <code language="C">
can't agree more
</code> </pre>
</div>
        </div>

    </li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</li><!-- #comment-## -->
</li><!-- #comment-## -->
    <li class="comment odd alt thread-even depth-1" id="dsq-comment-16066">
        <div id="dsq-comment-header-16066" class="dsq-comment-header">
            <cite id="dsq-cite-16066">
                <span id="dsq-author-user-16066">jobin</span>
            </cite>
        </div>
        <div id="dsq-comment-body-16066" class="dsq-comment-body">
            <div id="dsq-comment-message-16066" class="dsq-comment-message"><p>you should rename the variable start to localstart<br />
else if (sum &gt; maxSum)<br />
{            maxSum = sum;<br />
             *finish = i;<br />
             *start =  localstart;<br />
}</p>
<p>otherwise your start will be modified everytime the sum upto current point from previous start is -ve, note that this is not the starting point for max contiguous sum.</p>
</div>
        </div>

    </li><!-- #comment-## -->
    <li class="comment even thread-odd thread-alt depth-1" id="dsq-comment-15989">
        <div id="dsq-comment-header-15989" class="dsq-comment-header">
            <cite id="dsq-cite-15989">
                <span id="dsq-author-user-15989">rahul</span>
            </cite>
        </div>
        <div id="dsq-comment-body-15989" class="dsq-comment-body">
            <div id="dsq-comment-message-15989" class="dsq-comment-message"><p>Should the complexity not be O(n4) as Kadane&#8217;s itself is O(n).</p>
<pre> <code language="C">
/* Paste your code here (You may delete these lines if not writing code) */
</code> </pre>
</div>
        </div>

    <ul class="children">
    <li class="comment odd alt depth-2" id="dsq-comment-15996">
        <div id="dsq-comment-header-15996" class="dsq-comment-header">
            <cite id="dsq-cite-15996">
                <span id="dsq-author-user-15996">Zack</span>
            </cite>
        </div>
        <div id="dsq-comment-body-15996" class="dsq-comment-body">
            <div id="dsq-comment-message-15996" class="dsq-comment-message"><p>No,because your could do the sum of row in a growing manner.<br />
say you want to calculate any combination of columns start from 1,<br />
1&#8211;&gt; col[] = column 1 &#8216;s value<br />
2&#8211;&gt; add column 1&#8217;s value to col[] and you get column 1-2&#8217;s sum<br />
and so on.<br />
So the for i=0..n-1, for j=i..n takes O(n^2)<br />
and each iteration takes O(n) to calculate the best range sum.</p>
<pre> <code language="C">
/* Paste your code here (You may delete these lines if not writing code) */
</code> </pre>
</div>
        </div>

    <ul class="children">
    <li class="comment even depth-3" id="dsq-comment-16209">
        <div id="dsq-comment-header-16209" class="dsq-comment-header">
            <cite id="dsq-cite-16209">
                <span id="dsq-author-user-16209">San Holo</span>
            </cite>
        </div>
        <div id="dsq-comment-body-16209" class="dsq-comment-body">
            <div id="dsq-comment-message-16209" class="dsq-comment-message"><p>But look &#8211; say you have 2D array 3&#215;3.<br />
The structure is:<br />
for loop1(for loop2(for loop3, for loop4))<br />
First, the most outer one will be done 3 times. The second &#8211; for the first time 3 times, then 2, then 1. The third AND the fourth will be done the same amount of times &#8211; 3.<br />
So it&#8217;s like this:<br />
 3 -&gt; 3+3 &#8211; 6 times during each loop, gives us 18.<br />
2 -&gt; 3+3 &#8211; 18 + 12 = 30<br />
1 -&gt; 3+3 &#8211; 30 + 6 = 36.<br />
n^3 = 27; 36 &gt; 27.<br />
I&#8217;ll try to figure out if there&#8217;s a way to connect both loops&#8230; Of course my thinking might be wrong (I hope it is), if there&#8217;s an error in how I think, please respond.</p>
</div>
        </div>

    <ul class="children">
    <li class="comment odd alt depth-4" id="dsq-comment-16211">
        <div id="dsq-comment-header-16211" class="dsq-comment-header">
            <cite id="dsq-cite-16211">
                <span id="dsq-author-user-16211">San Holo</span>
            </cite>
        </div>
        <div id="dsq-comment-body-16211" class="dsq-comment-body">
            <div id="dsq-comment-message-16211" class="dsq-comment-message"><p>Well, anyway, I corrected my code and it&#8217;s definitely n^3 now. Actually, no, it&#8217;s even less.</p>
</div>
        </div>

    </li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
    <li class="comment even depth-3" id="dsq-comment-33141">
        <div id="dsq-comment-header-33141" class="dsq-comment-header">
            <cite id="dsq-cite-33141">
                <span id="dsq-author-user-33141">Warrior101</span>
            </cite>
        </div>
        <div id="dsq-comment-body-33141" class="dsq-comment-body">
            <div id="dsq-comment-message-33141" class="dsq-comment-message"><p>No. The complexity is O(n^4), even if you do progressive adds. Look at the code on this page- there are 3 for-loops and with Kadanes, that becomes O(n^4).</p>
</div>
        </div>

    </li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
            </ul>


        </div>

    </div>

<script type="text/javascript">
var disqus_url = 'http://www.geeksforgeeks.org/dynamic-programming-set-27-max-sum-rectangle-in-a-2d-matrix/';
var disqus_identifier = '115029 http://www.geeksforgeeks.org/?p=115029';
var disqus_container_id = 'disqus_thread';
var disqus_shortname = 'geeksforgeeks';
var disqus_title = "Dynamic Programming | Set 27 (Maximum sum rectangle in a 2D matrix)";
var disqus_config_custom = window.disqus_config;
var disqus_config = function () {
    /*
    All currently supported events:
    onReady: fires when everything is ready,
    onNewComment: fires when a new comment is posted,
    onIdentify: fires when user is authenticated
    */
    
    
    this.language = '';
    
    if (disqus_config_custom) {
        disqus_config_custom.call(this);
    }
};

(function() {
    var dsq = document.createElement('script'); dsq.type = 'text/javascript';
    dsq.async = true;
    dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
    (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
})();
</script>

			</div>
	
					
			
			

		</div> <!-- end post -->	

<br></br>
	
</div> <!-- end content -->

<ul id="sidebar">
	<li id="text-19" class="widget widget_text">			<div class="textwidget"><script>
  (function() {
    var cx = '009682134359037907028:tj6eafkv_be';
    var gcse = document.createElement('script');
    gcse.type = 'text/javascript';
    gcse.async = true;
    gcse.src = (document.location.protocol == 'https:' ? 'https:' : 'http:') +
        '//www.google.com/cse/cse.js?cx=' + cx;
    var s = document.getElementsByTagName('script')[0];
    s.parentNode.insertBefore(gcse, s);
  })();
</script>
<gcse:search></gcse:search>

<style type="text/css">
  .gsc-control-cse {
    font-family: "Trebuchet MS", sans-serif;
    border-color: #E1F3DA;
    background-color: #E1F3DA;
  }
  input.gsc-input {
    border-color: #94CC7A;
  }
  input.gsc-search-button {
    border-color: #94CC7A;
    background-color: #AADA92;
  }
  .gsc-tabHeader.gsc-tabhInactive {
    border-color: #A9DA92;
    background-color: #FFFFFF;
  }
  .gsc-tabHeader.gsc-tabhActive {
    border-color: #A9DA92;
    background-color: #A9DA92;
  }
  .gsc-tabsArea {
    border-color: #A9DA92;
  }
  .gsc-webResult.gsc-result {
    border-color: #A9DA92;
    background-color: #FFFFFF;
  }
  .gsc-webResult.gsc-result:hover {
    border-color: #A9DA92;
    background-color: #FFFFFF;
  }
  .gs-webResult.gs-result a.gs-title:link,
  .gs-webResult.gs-result a.gs-title:link b {
    color: #009900;
  }
  .gs-webResult.gs-result a.gs-title:visited,
  .gs-webResult.gs-result a.gs-title:visited b {
    color: #009900;
  }
  .gs-webResult.gs-result a.gs-title:hover,
  .gs-webResult.gs-result a.gs-title:hover b {
    color: #003300;
  }
  .gs-webResult.gs-result a.gs-title:active,
  .gs-webResult.gs-result a.gs-title:active b {
    color: #009900;
  }
  .gsc-cursor-page {
    color: #009900;
  }
  a.gsc-trailing-more-results:link {
    color: #009900;
  }
  .gs-webResult.gs-result .gs-snippet {
    color: #454545;
  }
  .gs-webResult.gs-result .gs-visibleUrl {
    color: #33cc00;
  }
  .gs-webResult.gs-result .gs-visibleUrl-short {
    color: #33cc00;
  }
  .gs-webResult.gs-result .gs-visibleUrl-short {
    display: none;
  }
  .gs-webResult.gs-result .gs-visibleUrl-long {
    display: block;
  }
  .gsc-cursor-box {
    border-color: #A9DA92;
  }
  .gsc-results .gsc-cursor-page {
    border-color: #A9DA92;
    background-color: #FFFFFF;
  }
  .gsc-results .gsc-cursor-page.gsc-cursor-current-page {
    border-color: #A9DA92;
    background-color: #A9DA92;
  }
  .gs-promotion.gs-result {
    border-color: #94CC7A;
    background-color: #CBE8B4;
  }
  .gs-promotion.gs-result a.gs-title:link {
    color: #0066CC;
  }
  .gs-promotion.gs-result a.gs-title:visited {
    color: #0066CC;
  }
  .gs-promotion.gs-result a.gs-title:hover {
    color: #0066CC;
  }
  .gs-promotion.gs-result a.gs-title:active {
    color: #0066CC;
  }
  .gs-promotion.gs-result .gs-snippet {
    color: #454545;
  }
  .gs-promotion.gs-result .gs-visibleUrl,
  .gs-promotion.gs-result .gs-visibleUrl-short {
    color: #815FA7;
  }
</style>    </div>
		</li>
<li id="text-9" class="widget widget_text">			<div class="textwidget"><div id="fb-root"></div>
<script>(function(d, s, id) {
  var js, fjs = d.getElementsByTagName(s)[0];
  if (d.getElementById(id)) return;
  js = d.createElement(s); js.id = id;
  js.src = "//connect.facebook.net/en_US/all.js#xfbml=1&appId=138031159685820";
  fjs.parentNode.insertBefore(js, fjs);
}(document, 'script', 'facebook-jssdk'));</script>

<div class="fb-like-box" data-href="https://www.facebook.com/pages/GeeksforGeeks/316764689022" data-width="250" data-height="170" data-colorscheme="light" data-show-faces="true" data-header="false" data-stream="false" data-show-border="false"></div></div>
		</li>
<li id="text-18" class="widget widget_text">			<div class="textwidget"><script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
<!-- LargeRectangleSide -->
<ins class="adsbygoogle"
     style="display:inline-block;width:336px;height:280px"
     data-ad-client="ca-pub-9465609616171866"
     data-ad-slot="1884636833"></ins>
<script>
(adsbygoogle = window.adsbygoogle || []).push({});
</script></div>
		</li>
<li id="text-13" class="widget widget_text">			<div class="textwidget"><ul><li><a href="http://www.geeksforgeeks.org/category/interview-experiences/">Interview Experiences</a></li>
<li><a href="http://www.geeksforgeeks.org/tag/advance-data-structures">Advanced Data Structures</a></li>
<li><a href="http://www.geeksforgeeks.org/tag/dynamic-programming">Dynamic Programming</a></li>
<li><a href="http://www.geeksforgeeks.org/tag/Greedy-Algorithm/">Greedy Algorithms</a></li>
<li><a href="http://www.geeksforgeeks.org/tag/backtracking">Backtracking</a></li>
<li><a href="http://www.geeksforgeeks.org/tag/pattern-searching">Pattern Searching</a></li>
<li><a href="http://www.geeksforgeeks.org/tag/divide-and-conquer">Divide & Conquer</a></li>
<li><a href="http://www.geeksforgeeks.org/tag/MathematicalAlgo">Mathematical Algorithms</a></li>
<li><a href="http://www.geeksforgeeks.org/tag/recursion">Recursion</a></li>
<li><a href="http://www.geeksforgeeks.org/tag/geometric-algorithms/">Geometric Algorithms</a></li>
</ul></div>
		</li>
<li id="text-17" class="widget widget_text">			<div class="textwidget"><script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
<!-- Big 300x600 Sidebar -->
<ins class="adsbygoogle"
     style="display:inline-block;width:300px;height:600px"
     data-ad-client="ca-pub-9465609616171866"
     data-ad-slot="4402736037"></ins>
<script>
(adsbygoogle = window.adsbygoogle || []).push({});
</script></div>
		</li>
<li id="text-14" class="widget widget_text"><h2 class="widgettitle">Popular Posts</h2>
			<div class="textwidget"><ul>
<li><a href="http://www.geeksforgeeks.org/write-a-c-program-to-print-all-permutations-of-a-given-string/">  All permutations of a given string </a></li>
<li><a href="http://www.geeksforgeeks.org/memory-layout-of-c-program/"> Memory Layout of C Programs</a> </li>
<li><a href="http://www.geeksforgeeks.org/understanding-extern-keyword-in-c/"> Understanding “extern” keyword in C</a> </li>
<li><a href="http://www.geeksforgeeks.org/median-of-two-sorted-arrays/">Median of two sorted arrays</a> </li>
<li><a href="http://www.geeksforgeeks.org/inorder-tree-traversal-without-recursion-and-without-stack/"> Tree traversal without recursion and without stack! </a></li>
<li><a href="http://www.geeksforgeeks.org/structure-member-alignment-padding-and-data-packing/"> Structure Member Alignment, Padding and Data Packing</a> </li>
<li><a href="http://www.geeksforgeeks.org/write-a-function-to-get-the-intersection-point-of-two-linked-lists/"> Intersection point of two Linked Lists</a> </li>
<li><a href="http://www.geeksforgeeks.org/lowest-common-ancestor-in-a-binary-search-tree/"> Lowest Common Ancestor in a BST.</span></a> </li>
<li><a href="http://www.geeksforgeeks.org/a-program-to-check-if-a-binary-tree-is-bst-or-not/"> Check if a binary tree is BST or not</a> </li>
<li><a href="http://www.geeksforgeeks.org/sorted-linked-list-to-balanced-bst/"> Sorted Linked List to Balanced BST</a></li>
</ul></div>
		</li>
<li id="text-3" class="widget widget_text">			<div class="textwidget"><a href="https://twitter.com/GeeksforGeeks" class="twitter-follow-button" data-show-count="false">Follow @GeeksforGeeks</a>
<script>!function(d,s,id){var js,fjs=d.getElementsByTagName(s)[0];if(!d.getElementById(id)){js=d.createElement(s);js.id=id;js.src="//platform.twitter.com/widgets.js";fjs.parentNode.insertBefore(js,fjs);}}(document,"script","twitter-wjs");</script>         


<!-- GOOGLE FEEDBURNER BUTTON-->
<a href="http://feeds.feedburner.com/Geeksforgeeks" title="Subscribe to my feed" rel="alternate" type="application/rss+xml"><img src="http://www.feedburner.com/fb/images/pub/feed-icon32x32.png" alt="" style="border:0"/></a><a href="http://feeds.feedburner.com/Geeksforgeeks" title="Subscribe to my feed" rel="alternate" type="application/rss+xml">Subscribe</a>

</div>
		</li>
<li id="text-21" class="widget widget_text"><h2 class="widgettitle">Recent Comments</h2>
			<div class="textwidget"><script type="text/javascript" src="http://geeksforgeeks.disqus.com//recent_comments_widget.js?num_items=6&hide_avatars=1&excerpt_length=50&hide_mods=0"></script></div>
		</li>
<li id="text-22" class="widget widget_text">			<div class="textwidget"><script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
<!-- LinkAd -->
<ins class="adsbygoogle"
     style="display:inline-block;width:160px;height:90px"
     data-ad-client="ca-pub-9465609616171866"
     data-ad-slot="2606115235"></ins>
<script>
(adsbygoogle = window.adsbygoogle || []).push({});
</script>

<script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
<!-- LinkAd -->
<ins class="adsbygoogle"
     style="display:inline-block;width:160px;height:90px"
     data-ad-client="ca-pub-9465609616171866"
     data-ad-slot="2606115235"></ins>
<script>
(adsbygoogle = window.adsbygoogle || []).push({});
</script>

<script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
<!-- LinkAd -->
<ins class="adsbygoogle"
     style="display:inline-block;width:160px;height:90px"
     data-ad-client="ca-pub-9465609616171866"
     data-ad-slot="2606115235"></ins>
<script>
(adsbygoogle = window.adsbygoogle || []).push({});
</script></div>
		</li>

</ul>					  
		<div class="clear"></div>

		<div id="footer">
		
		    <div class="xhtml">
                        @geeksforgeeks, <a href="http://creativecommons.org/licenses/by-nc-nd/2.5/in/deed.en_US" title="Valid XHTML Strict 1.0">Some rights reserved</a>  <a href="http://www.geeksforgeeks.org/about/contact-us/"> &nbsp; &nbsp; &nbsp; &nbsp;Contact Us!</a>

		    </div>
		    
		    <div class="credits">
			  Powered by <a href="http://wordpress.org">WordPress </a> &amp; <a href="http://mootools.net/" title="Mootools JavaScript Framework">MooTools</a>, customized by geeksforgeeks team </div>
			  
		   <div class="clear"></div>						                            
		   
		</div> <!--end footer-->  
        
		        <script type="text/javascript">
        // <![CDATA[
        var disqus_shortname = 'geeksforgeeks';
        (function () {
            var nodes = document.getElementsByTagName('span');
            for (var i = 0, url; i < nodes.length; i++) {
                if (nodes[i].className.indexOf('dsq-postid') != -1) {
                    nodes[i].parentNode.setAttribute('data-disqus-identifier', nodes[i].getAttribute('rel'));
                    url = nodes[i].parentNode.href.split('#', 1);
                    if (url.length == 1) { url = url[0]; }
                    else { url = url[1]; }
                    nodes[i].parentNode.href = url + '#disqus_thread';
                }
            }
            var s = document.createElement('script'); 
            s.async = true;
            s.type = 'text/javascript';
            s.src = '//' + disqus_shortname + '.disqus.com/count.js';
            (document.getElementsByTagName('HEAD')[0] || document.getElementsByTagName('BODY')[0]).appendChild(s);
        }());
        // ]]>
        </script>
        <script type='text/javascript' src='http://d2o58evtke57tz.cloudfront.net/wp-content/plugins/syntaxhighlighter/syntaxhighlighter3/scripts/shCore.js?ver=3.0.9'></script>
<script type='text/javascript' src='http://d2o58evtke57tz.cloudfront.net/wp-content/plugins/syntaxhighlighter/syntaxhighlighter3/scripts/shBrushCpp.js?ver=3.0.9'></script>
<script type='text/javascript'>
	(function(){
		var corecss = document.createElement('link');
		var themecss = document.createElement('link');
		var corecssurl = "http://d2o58evtke57tz.cloudfront.net/wp-content/plugins/syntaxhighlighter/syntaxhighlighter3/styles/shCore.css?ver=3.0.9";
		if ( corecss.setAttribute ) {
				corecss.setAttribute( "rel", "stylesheet" );
				corecss.setAttribute( "type", "text/css" );
				corecss.setAttribute( "href", corecssurl );
		} else {
				corecss.rel = "stylesheet";
				corecss.href = corecssurl;
		}
		document.getElementsByTagName("head")[0].insertBefore( corecss, document.getElementById("syntaxhighlighteranchor") );
		var themecssurl = "http://d2o58evtke57tz.cloudfront.net/wp-content/plugins/syntaxhighlighter/syntaxhighlighter3/styles/shThemeDefault.css?ver=3.0.9";
		if ( themecss.setAttribute ) {
				themecss.setAttribute( "rel", "stylesheet" );
				themecss.setAttribute( "type", "text/css" );
				themecss.setAttribute( "href", themecssurl );
		} else {
				themecss.rel = "stylesheet";
				themecss.href = themecssurl;
		}
		//document.getElementById("syntaxhighlighteranchor").appendChild(themecss);
		document.getElementsByTagName("head")[0].insertBefore( themecss, document.getElementById("syntaxhighlighteranchor") );
	})();
	SyntaxHighlighter.config.strings.expandSource = '+ expand source';
	SyntaxHighlighter.config.strings.help = '?';
	SyntaxHighlighter.config.strings.alert = 'SyntaxHighlighter\n\n';
	SyntaxHighlighter.config.strings.noBrush = 'Can\'t find brush for: ';
	SyntaxHighlighter.config.strings.brushNotHtmlScript = 'Brush wasn\'t configured for html-script option: ';
	SyntaxHighlighter.defaults['gutter'] = false;
	SyntaxHighlighter.defaults['pad-line-numbers'] = true;
	SyntaxHighlighter.defaults['toolbar'] = false;
	SyntaxHighlighter.all();
</script>
<script type='text/javascript' src='http://d2o58evtke57tz.cloudfront.net/wp-content/plugins/bbpress/templates/default/js/editor.js?ver=2.5.4-5380'></script>
				  
		</div> <!--end wrapper-->
        <div id="ajaxSpinner"></div> <!--For AJAX spinner holder-->
<script type="text/javascript">

  var _gaq = _gaq || [];
  _gaq.push(['_setAccount', 'UA-12148232-1']);
  _gaq.push(['_trackPageview']);

  (function() {
    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
  })();

</script>
	</body>

</html>
<!-- Dynamic page generated in 0.217 seconds. -->
<!-- Cached page generated by WP-Super-Cache on 2014-11-27 23:27:36 -->

<!-- Compression = gzip -->
<!-- super cache -->