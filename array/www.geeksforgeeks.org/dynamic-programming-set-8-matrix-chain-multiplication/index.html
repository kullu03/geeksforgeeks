<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">

<head>
       <title>Dynamic Programming | Set 8 (Matrix Chain Multiplication) - GeeksforGeeks</title>
       <style type="text/css" media="screen">
          @import url('http://d2o58evtke57tz.cloudfront.net/wp-content/themes/minimoo/style.css');
    </style>
      <link href="http://d2o58evtke57tz.cloudfront.net/wp-content/themes/minimoo/favicon.ico" rel="shortcut icon" />    
    
<!-- This site is optimized with the Yoast WordPress SEO plugin v1.7.1 - https://yoast.com/wordpress/plugins/seo/ -->
<link rel="canonical" href="http://www.geeksforgeeks.org/dynamic-programming-set-8-matrix-chain-multiplication/" />
<meta property="og:locale" content="en_US" />
<meta property="og:type" content="article" />
<meta property="og:title" content="Dynamic Programming | Set 8 (Matrix Chain Multiplication) - GeeksforGeeks" />
<meta property="og:description" content="Given a sequence of matrices, find the most efficient way to multiply these matrices together. The problem is not actually to perform the multiplications, but merely to decide in which order to perform the multiplications. We have many options to multiply a chain of matrices because matrix multiplication is associative. In other words, no matter &hellip;" />
<meta property="og:url" content="http://www.geeksforgeeks.org/dynamic-programming-set-8-matrix-chain-multiplication/" />
<meta property="og:site_name" content="GeeksforGeeks" />
<meta property="article:tag" content="Dynamic Programming" />
<meta property="article:section" content="Misc" />
<meta property="article:published_time" content="2012-02-02T15:15:31+00:00" />
<meta property="article:modified_time" content="2014-04-23T10:57:29+00:00" />
<meta property="og:updated_time" content="2014-04-23T10:57:29+00:00" />
<meta property="og:image" content="http://d2o58evtke57tz.cloudfront.net/wp-content/uploads/MatrixChain1.jpg" />
<!-- / Yoast WordPress SEO plugin. -->

<link rel='stylesheet' id='wp-quicklatex-format-css'  href='http://d2o58evtke57tz.cloudfront.net/wp-content/plugins/wp-quicklatex/css/quicklatex-format.css?ver=4.0.1' type='text/css' media='all' />
<link rel='stylesheet' id='bbp-default-css'  href='http://d2o58evtke57tz.cloudfront.net/wp-content/plugins/bbpress/templates/default/css/bbpress.css?ver=2.5.4-5380' type='text/css' media='screen' />
<link rel='stylesheet' id='wp-pagenavi-css'  href='http://d2o58evtke57tz.cloudfront.net/wp-content/plugins/wp-pagenavi/pagenavi-css.css?ver=2.70' type='text/css' media='all' />
<script type='text/javascript' src='http://d2o58evtke57tz.cloudfront.net/wp-includes/js/jquery/jquery.js?ver=1.11.1'></script>
<script type='text/javascript' src='http://d2o58evtke57tz.cloudfront.net/wp-includes/js/jquery/jquery-migrate.min.js?ver=1.2.1'></script>
<script type='text/javascript' src='http://d2o58evtke57tz.cloudfront.net/wp-content/plugins/wp-quicklatex/js/wp-quicklatex-frontend.js?ver=1.0'></script>

<!-- Bad Behavior 2.2.16 run time: 1.538 ms -->
<script type="text/javascript">
<!--
function bb2_addLoadEvent(func) {
	var oldonload = window.onload;
	if (typeof window.onload != 'function') {
		window.onload = func;
	} else {
		window.onload = function() {
			oldonload();
			func();
		}
	}
}

bb2_addLoadEvent(function() {
	for ( i=0; i < document.forms.length; i++ ) {
		if (document.forms[i].method == 'post') {
			var myElement = document.createElement('input');
			myElement.setAttribute('type', 'hidden');
			myElement.name = 'bb2_screener_';
			myElement.value = '1417111084 103.230.107.10';
			document.forms[i].appendChild(myElement);
		}
	}
});
// --></script>
		<style type="text/css" id="syntaxhighlighteranchor"></style>
   <meta name="google-site-verification" content="rHK2v8_zzuAZQY8JHAzbllDN8u-aQxcn2Kqnp67Old0" />
</head>

<body>
<!-- o4dI0sCXUgoSONabbd8mbZ4SA3E -->    
    <div id="wrapper">
        <div class="blog-info">
                <h1 class="blog-title">
                <a href="http://www.geeksforgeeks.org" title="GeeksforGeeks">GeeksforGeeks</a>
            </h1>
       
            <div class="blog-description">
                A computer science portal for geeks            </div>
        </div>
        <b><p>  <h2 align="right"> <a href="http://geeksquiz.com/">GeeksQuiz</a></h2> 
   <a href="http://www.geeksforgeeks.org/wp-login.php">Login</a> 
         </p></b>  
         
         <div class="clear"></div>         
              
                     
            <div id="menu">   
                 <ul>
 <li><a href="http://www.geeksforgeeks.org">Home</a></li>
  <li><a href="http://www.geeksforgeeks.org/fundamentals-of-algorithms/">Algorithms</a></li>
 <li><a href="http://www.geeksforgeeks.org/data-structures/">DS</a></li>
  <li><a href="http://www.geeksforgeeks.org/gate-corner/">GATE</a></li>
  <li><a href="http://www.geeksforgeeks.org/about/interview-corner/">Interview Corner</a></li>
  <li><a href="http://www.geeksforgeeks.org/forums/">Q&A</a></li>
  <li><a href="http://www.geeksforgeeks.org/c/">C</a></li>
  <li><a href="http://www.geeksforgeeks.org/c-plus-plus/">C++</a></li>
  <li><a href="http://www.geeksforgeeks.org/java/">Java</a></li>
  <li><a href="http://www.geeksforgeeks.org/books/">Books</a></li>
  <li><a href="http://www.geeksforgeeks.org/contribute/">Contribute</a></li>
  <li><a href="http://www.geeksforgeeks.org/contribute/ask-a-question/">Ask a Q</a></li>
  <li><a href="http://www.geeksforgeeks.org/about/">About</a></li>
            </ul>

               
            <div class="clear"></div>     
        </div>
             <div id="navmenu">
				<ul id="menu" style="padding:0; margin:0;">
						<li class="cat-item cat-item-3"><a href="http://www.geeksforgeeks.org/category/c-arrays/" title="Questions regarding Arrays">Array</a>
</li>	

	<li class="cat-item cat-item-17"><a href="http://www.geeksforgeeks.org/category/bit-magic/" title="View all posts filed under Bit Magic">Bit Magic</a>
</li>
	<li class="cat-item cat-item-14"><a href="http://www.geeksforgeeks.org/category/c-puzzles/" title="View all posts filed under C/C++ Puzzles">C/C++</a>
</li>

<li class="cat-item cat-item-18"><a href="http://www.geeksforgeeks.org/category/articles/" title="View all posts filed under Articles">Articles</a>
</li>

	<li class="cat-item cat-item-67"><a href="http://www.geeksforgeeks.org/category/gfact/" title="View all posts filed under GFacts">GFacts</a>
</li>
	<li class="cat-item cat-item-8"><a href="http://www.geeksforgeeks.org/category/linked-list/" title="Linked List problems">Linked List</a>
</li>
	<li class="cat-item cat-item-66"><a href="http://www.geeksforgeeks.org/category/multiple-choice-question/" title="View all posts filed under MCQ">MCQ</a>

</li>
	<li class="cat-item cat-item-4"><a href="http://www.geeksforgeeks.org/category/c-programs/" title="Miscellaneous">Misc</a>
</li>
	<li class="cat-item cat-item-5"><a href="http://www.geeksforgeeks.org/category/program-output/" title="View all posts filed under Output">Output</a>
</li>
	<li class="cat-item cat-item-7"><a href="http://www.geeksforgeeks.org/category/c-strings/" title="Questions related to strings">String</a>
</li>
	<li class="cat-item cat-item-19"><a href="http://www.geeksforgeeks.org/category/tree/" title="View all posts filed under Trees">Tree</a>
</li>
	<li class="cat-item cat-item-19"><a href="http://www.geeksforgeeks.org/category/graph/" title="View all posts filed under Graph">Graph</a>
</li>
</ul>
        </div>
             <div id="content">	   	
	<div class="post" id="post">
							<div class="post-info">			
					<div class="post-title-info">
						<h2 class="post-title">Dynamic Programming | Set 8 (Matrix Chain Multiplication)</h2>
					</div>			
					<div class="clear"></div>				  
				<div class="post-content" id="post-content">
					<p>Given a sequence of matrices, find the most efficient way to multiply these matrices together.<span id="more-15553"></span> The problem is not actually to perform the multiplications, but merely to decide in which order to perform the multiplications.</p>
<p>We have many options to multiply a chain of matrices because matrix multiplication is associative. In other words, no matter how we parenthesize the product, the result will be the same. For example, if we had four matrices A, B, C, and D, we would have:</p>
<pre>
    (ABC)D = (AB)(CD) = A(BCD) = ....
</pre>
<p>However, the order in which we parenthesize the product affects the number of simple arithmetic operations needed to compute the product, or the efficiency. For example, suppose A is a 10 × 30 matrix, B is a 30 × 5 matrix, and C is a 5 × 60 matrix. Then,</p>
<pre>
    (AB)C = (10×30×5) + (10×5×60) = 1500 + 3000 = 4500 operations
    A(BC) = (30×5×60) + (10×30×60) = 9000 + 18000 = 27000 operations.
</pre>
<p>Clearly the first parenthesization requires less number of operations. </p>
<p><em>Given an array p[] which represents the chain of matrices such that the ith matrix Ai is of dimension p[i-1] x p[i]. We need to write a function MatrixChainOrder() that should return the minimum number of multiplications needed to multiply the chain.</em></p>
<pre>
  <strong>Input: p[] = {40, 20, 30, 10, 30} </strong>  
  <strong>Output: 26000  </strong>
  There are 4 matrices of dimensions 40x20, 20x30, 30x10 and 10x30.
  Let the input 4 matrices be A, B, C and D.  The minimum number of 
  multiplications are obtained by putting parenthesis in following way
  (A(BC))D --> 20*30*10 + 40*20*10 + 40*10*30

  <strong>Input: p[] = {10, 20, 30, 40, 30} </strong>
  <strong>Output: 30000 </strong>
  There are 4 matrices of dimensions 10x20, 20x30, 30x40 and 40x30. 
  Let the input 4 matrices be A, B, C and D.  The minimum number of 
  multiplications are obtained by putting parenthesis in following way
  ((AB)C)D --> 10*20*30 + 10*30*40 + 10*40*30

  <strong>Input: p[] = {10, 20, 30}  </strong>
  <strong>Output: 6000 </strong> 
  There are only two matrices of dimensions 10x20 and 20x30. So there 
  is only one way to multiply the matrices, cost of which is 10*20*30
</pre>
<p><strong>1) Optimal Substructure:</strong><br />
A simple solution is to place parenthesis at all possible places, calculate the cost for each placement and return the minimum value.  In a chain of matrices of size n, we can place the first set of parenthesis in n-1 ways.  For example, if the given chain is of 4 matrices. let the chain be ABCD, then there are 3 way to place first set of parenthesis:  A(BCD), (AB)CD and (ABC)D.  So when we place a set of parenthesis, we divide the problem into subproblems of smaller size.  Therefore, the problem has optimal substructure property and can be easily solved using recursion.</p>
<p>Minimum number of multiplication needed to multiply a chain of size n = Minimum of all n-1 placements (these placements create subproblems of smaller size)</p>
<p><strong>2) Overlapping Subproblems</strong><br />
Following is a recursive implementation that simply follows the above optimal substructure property. </p>
<pre class="brush: cpp; highlight: [6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30]; title: ; notranslate" title="">
/* A naive recursive implementation that simply follows the above optimal 
 substructure property */
#include&lt;stdio.h&gt;
#include&lt;limits.h&gt;

// Matrix Ai has dimension p[i-1] x p[i] for i = 1..n
int MatrixChainOrder(int p[], int i, int j)
{
    if(i == j)
        return 0;
    int k;
    int min = INT_MAX;
    int count;

    // place parenthesis at different places between first and last matrix,
    // recursively calculate count of multiplcations for each parenthesis 
    // placement and return the minimum count
    for (k = i; k &lt;j; k++)
    {
        count = MatrixChainOrder(p, i, k) +
                MatrixChainOrder(p, k+1, j) +
                p[i-1]*p[k]*p[j];

        if (count &lt; min)
            min = count;
    }

    // Return minimum count
    return min;
}

// Driver program to test above function
int main()
{
    int arr[] = {1, 2, 3, 4, 3};
    int n = sizeof(arr)/sizeof(arr[0]);

    printf(&quot;Minimum number of multiplications is %d &quot;, 
                          MatrixChainOrder(arr, 1, n-1));

    getchar();
    return 0;
}
</pre>
<p>Time complexity of the above naive recursive approach is exponential. It should be noted that the above function computes the same subproblems again and again. See the following recursion tree for a matrix chain of size 4.  The function MatrixChainOrder(p, 3, 4) is called two times. We can see that there are many subproblems being called more than once.</p>
<p><a href="http://d2o58evtke57tz.cloudfront.net/wp-content/uploads/MatrixChain1.jpg"><img src="http://d2o58evtke57tz.cloudfront.net/wp-content/uploads/MatrixChain1.jpg" alt="" title="MatrixChain" width="456" height="185" class="aligncenter size-full wp-image-17568" /></a></p>
<p>Since same suproblems are called again, this problem has Overlapping Subprolems property. So Matrix Chain Multiplication problem has both properties (see <a href="http://www.geeksforgeeks.org/archives/12635">this </a>and <a href="http://www.geeksforgeeks.org/archives/12819">this</a>) of a dynamic programming problem. Like other typical <a href="http://www.geeksforgeeks.org/archives/tag/dynamic-programming">Dynamic Programming(DP) problems</a>, recomputations of same subproblems can be avoided by constructing a temporary array m[][] in bottom up manner.</p>
<p><strong>Dynamic Programming Solution</strong><br />
Following is C/C++ implementation for Matrix Chain Multiplication problem using Dynamic Programming. </p>
<pre class="brush: cpp; highlight: [5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41]; title: ; notranslate" title="">
// See the Cormen book for details of the following algorithm
#include&lt;stdio.h&gt;
#include&lt;limits.h&gt;

// Matrix Ai has dimension p[i-1] x p[i] for i = 1..n
int MatrixChainOrder(int p[], int n)
{

    /* For simplicity of the program, one extra row and one extra column are
       allocated in m[][].  0th row and 0th column of m[][] are not used */
    int m[n][n];

    int i, j, k, L, q;

    /* m[i,j] = Minimum number of scalar multiplications needed to compute
       the matrix A[i]A[i+1]...A[j] = A[i..j] where dimention of A[i] is
       p[i-1] x p[i] */

    // cost is zero when multiplying one matrix.
    for (i = 1; i &lt; n; i++)
        m[i][i] = 0;

    // L is chain length.  
    for (L=2; L&lt;n; L++)   
    {
        for (i=1; i&lt;=n-L+1; i++)
        {
            j = i+L-1;
            m[i][j] = INT_MAX;
            for (k=i; k&lt;=j-1; k++)
            {
                // q = cost/scalar multiplications
                q = m[i][k] + m[k+1][j] + p[i-1]*p[k]*p[j];
                if (q &lt; m[i][j])
                    m[i][j] = q;
            }
        }
    }

    return m[1][n-1];
}

int main()
{
    int arr[] = {1, 2, 3, 4};
    int size = sizeof(arr)/sizeof(arr[0]);

    printf(&quot;Minimum number of multiplications is %d &quot;,
                       MatrixChainOrder(arr, size));

    getchar();
    return 0;
}
</pre>
<p>Time Complexity: O(n^3)<br />
Auxiliary Space: O(n^2)</p>
<p>Please write comments if you find anything incorrect, or you want to share more information about the topic discussed above.</p>
<p><strong>References:</strong><br />
<a href="http://en.wikipedia.org/wiki/Matrix_chain_multiplication">http://en.wikipedia.org/wiki/Matrix_chain_multiplication</a><br />
<a href="http://www.personal.kent.edu/~rmuhamma/Algorithms/MyAlgorithms/Dynamic/chainMatrixMult.htm">http://www.personal.kent.edu/~rmuhamma/Algorithms/MyAlgorithms/Dynamic/chainMatrixMult.htm</a></p>
		
&nbsp;
&nbsp;
<script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
<!-- Big Rectangle Blog Bottom -->
<ins class="adsbygoogle"
     style="display:inline-block;width:336px;height:280px"
     data-ad-client="ca-pub-9465609616171866"
     data-ad-slot="4061219431"></ins>
<script>
(adsbygoogle = window.adsbygoogle || []).push({});
</script>



&nbsp;
&nbsp;
&nbsp;
<h3>Related Topics:</h3><ul><li><a href="http://www.geeksforgeeks.org/job-sequencing-problem-set-1-greedy-algorithm/" title="Job Sequencing Problem | Set 1 (Greedy Algorithm)">Job Sequencing Problem | Set 1 (Greedy Algorithm)</a></li><li><a href="http://www.geeksforgeeks.org/multiply-two-polynomials-2/" title="Multiply two polynomials">Multiply two polynomials</a></li><li><a href="http://www.geeksforgeeks.org/algorithm-practice-question-beginners-set-1/" title="Algorithm Practice Question for Beginners | Set 1">Algorithm Practice Question for Beginners | Set 1</a></li><li><a href="http://www.geeksforgeeks.org/count-distinct-non-negative-pairs-x-y-satisfy-inequality-xx-yy-n-2/" title="Count Distinct Non-Negative Integer Pairs (x, y) that Satisfy the Inequality x*x + y*y &lt; n">Count Distinct Non-Negative Integer Pairs (x, y) that Satisfy the Inequality x*x + y*y < n</a></li><li><a href="http://www.geeksforgeeks.org/binomial-heap-2/" title="Binomial Heap">Binomial Heap</a></li><li><a href="http://www.geeksforgeeks.org/print-increasing-sequences-length-k-first-n-natural-numbers/" title="Print all increasing sequences of length k from first n natural numbers">Print all increasing sequences of length k from first n natural numbers</a></li><li><a href="http://www.geeksforgeeks.org/find-nth-number-number-system-3-4/" title="Find n&#8217;th number in a number system with only 3 and 4">Find n&#8217;th number in a number system with only 3 and 4</a></li><li><a href="http://www.geeksforgeeks.org/minimum-cost-polygon-triangulation/" title="Minimum Cost Polygon Triangulation">Minimum Cost Polygon Triangulation</a></li></ul>
<p>Tags: <a href="http://www.geeksforgeeks.org/tag/dynamic-programming/" rel="tag">Dynamic Programming</a></p> 
<div>
<iframe src="http://www.facebook.com/plugins/like.php?href=http%3A%2F%2Fwww.geeksforgeeks.org%2Fdynamic-programming-set-8-matrix-chain-multiplication%2F&layout=button_count&show_faces=false&width=90&action=like&colorscheme=light" scrolling="no" frameborder="0" allowTransparency="true" style="border:none; overflow:hidden; width:90px; height:20px"></iframe>
<a href="http://twitter.com/share" class="twitter-share-button" data-url="http://www.geeksforgeeks.org/dynamic-programming-set-8-matrix-chain-multiplication/" data-text="Dynamic Programming | Set 8 (Matrix Chain Multiplication)" data-count="horizontal" data-via="jakerutter">Tweet</a><script type="text/javascript" src="http://platform.twitter.com/widgets.js"></script>
<g:plusone size="medium" href="http://www.geeksforgeeks.org/dynamic-programming-set-8-matrix-chain-multiplication/"></g:plusone>
<!-- Place this render call where appropriate -->
<script type="text/javascript">
  (function() {
    var po = document.createElement('script'); po.type = 'text/javascript'; po.async = true;
    po.src = 'https://apis.google.com/js/plusone.js';
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(po, s);
  })();
</script></div>





				</div>		  
			</div> <!-- end post main -->					
			<div class="post-meta">
				<div class="left"></div>				
				<div class="clear"></div>
			</div>			
        
			<div class="comments-main">		
 <b>Writing code in comment?</b> Please use <b><a href="http://ideone.com/">ideone.com</a></b> and share the link here.
				
<div id="disqus_thread">
            <div id="dsq-content">


            <ul id="dsq-comments">
                    <li class="comment even thread-even depth-1" id="dsq-comment-34258">
        <div id="dsq-comment-header-34258" class="dsq-comment-header">
            <cite id="dsq-cite-34258">
                <span id="dsq-author-user-34258">Shubham</span>
            </cite>
        </div>
        <div id="dsq-comment-body-34258" class="dsq-comment-body">
            <div id="dsq-comment-message-34258" class="dsq-comment-message"><p>Why couldn&#8217;t you just write a program where for loop starts indexing from<br />
i=0 instead of first start from i = 1 then access array element by a[i-1]</p>
</div>
        </div>

    </li><!-- #comment-## -->
    <li class="comment odd alt thread-odd thread-alt depth-1" id="dsq-comment-34120">
        <div id="dsq-comment-header-34120" class="dsq-comment-header">
            <cite id="dsq-cite-34120">
                <span id="dsq-author-user-34120">Guest</span>
            </cite>
        </div>
        <div id="dsq-comment-body-34120" class="dsq-comment-body">
            <div id="dsq-comment-message-34120" class="dsq-comment-message"><p>what is &#8220;INT_MAX&#8221; used in the above programs ?</p>
</div>
        </div>

    <ul class="children">
    <li class="comment even depth-2" id="dsq-comment-34125">
        <div id="dsq-comment-header-34125" class="dsq-comment-header">
            <cite id="dsq-cite-34125">
                <span id="dsq-author-user-34125">Tarzan</span>
            </cite>
        </div>
        <div id="dsq-comment-body-34125" class="dsq-comment-body">
            <div id="dsq-comment-message-34125" class="dsq-comment-message"><p>its a macro defined in limits.h. It is the maximum value integer can take. Corresponding to the same we have INT_MIN.</p>
</div>
        </div>

    </li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
    <li class="comment odd alt thread-even depth-1" id="dsq-comment-32415">
        <div id="dsq-comment-header-32415" class="dsq-comment-header">
            <cite id="dsq-cite-32415">
                <span id="dsq-author-user-32415">paras_meena</span>
            </cite>
        </div>
        <div id="dsq-comment-body-32415" class="dsq-comment-body">
            <div id="dsq-comment-message-32415" class="dsq-comment-message"><p>//Simple and neat And Same as this tutorial =P</p>
<p>#include </p>
<p>#define _ ios_base::sync_with_stdio(0);cin.tie(0);</p>
<p>using namespace std;</p>
<p>#define ll long long</p>
<p>int main()</p>
<p>{</p>
<p>	int N;</p>
<p>	scanf(&#8220;%d&#8221;, &amp;N);</p>
<p>	int dp[N+4][N+4];</p>
<p>	int arr[N+4];</p>
<p>	for(int i = 0; i &lt; N; ++i) {</p>
<p>		scanf(&quot;%d&quot;, &amp;arr[i]);</p>
<p>	}</p>
<p>	for(int i = 0; i &lt; N; ++i) {</p>
<p>		for(int j = 0; j &lt; N; ++j) {</p>
<p>			dp[i][j] = 1e9;</p>
<p>		}</p>
<p>		dp[i][i] = arr[i];</p>
<p>	}</p>
<p>	for(int l = 2; l &lt; N+1; ++l) {</p>
<p>		for(int i = 0; i &lt; N &#8211; l + 1; ++i) {</p>
<p>			int j = i + l &#8211; 1;</p>
<p>			for(int k = i; k &lt; j; ++k) {</p>
<p>				dp[i][j] = min(dp[i][j], dp[i][k] * dp[k+1][j]);</p>
<p>			}</p>
<p>		}</p>
<p>	}</p>
<p>	cout&lt;&lt; dp[0][N-1] &lt;&lt; &quot;n&quot;;</p>
<p>	return 0;</p>
<p>}</p>
</div>
        </div>

    </li><!-- #comment-## -->
    <li class="comment even thread-odd thread-alt depth-1" id="dsq-comment-30952">
        <div id="dsq-comment-header-30952" class="dsq-comment-header">
            <cite id="dsq-cite-30952">
                <span id="dsq-author-user-30952">its_dark</span>
            </cite>
        </div>
        <div id="dsq-comment-body-30952" class="dsq-comment-body">
            <div id="dsq-comment-message-30952" class="dsq-comment-message"><p>Bottom-Up Dp :<br />
<code><br />
int dp[10][10];<br />
int calc(int p[], int b, int e){<br />
    int &amp;x = dp[b][e];<br />
    if(x != -1)<br />
        return x;<br />
    if(b==e) return x=0;<br />
    int min=INT_MAX, ans;<br />
    for (int i = b; i &lt; e; ++i)<br />
    {<br />
        ans = calc(p,b,i) + calc(p,i+1,e) + p[b-1]*p[i]*p[e];<br />
        if(ans &lt; min)min = ans;<br />
    }<br />
    return x=min;<br />
}<br />
</code><br />
call with b=0, e=n-1</p>
</div>
        </div>

    </li><!-- #comment-## -->
    <li class="comment odd alt thread-even depth-1" id="dsq-comment-30833">
        <div id="dsq-comment-header-30833" class="dsq-comment-header">
            <cite id="dsq-cite-30833">
                <span id="dsq-author-user-30833">Ali</span>
            </cite>
        </div>
        <div id="dsq-comment-body-30833" class="dsq-comment-body">
            <div id="dsq-comment-message-30833" class="dsq-comment-message"><p>&#8220;n a chain of matrices of size n, we can place the first set of parenthesis in n-1 ways.&#8221; &#8211; this seems to be wrong. It should be nsquare/2.</p>
</div>
        </div>

    </li><!-- #comment-## -->
    <li class="comment even thread-odd thread-alt depth-1" id="dsq-comment-27613">
        <div id="dsq-comment-header-27613" class="dsq-comment-header">
            <cite id="dsq-cite-27613">
                <span id="dsq-author-user-27613">Vinodhini</span>
            </cite>
        </div>
        <div id="dsq-comment-body-27613" class="dsq-comment-body">
            <div id="dsq-comment-message-27613" class="dsq-comment-message"><p>I guess the following loop is wrong. i &lt; n-L+1 should be correct. Because it starts accessing the index that are out of bounds.</p>
<p>for (i=1; i&lt;=n-L+1; i++)</p>
<p>Please correct me if I am wrong.</p>
</div>
        </div>

    <ul class="children">
    <li class="comment odd alt depth-2" id="dsq-comment-31242">
        <div id="dsq-comment-header-31242" class="dsq-comment-header">
            <cite id="dsq-cite-31242">
                <span id="dsq-author-user-31242">jugal</span>
            </cite>
        </div>
        <div id="dsq-comment-body-31242" class="dsq-comment-body">
            <div id="dsq-comment-message-31242" class="dsq-comment-message"><p>yes, you r right.</p>
</div>
        </div>

    </li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
    <li class="comment even thread-even depth-1" id="dsq-comment-27214">
        <div id="dsq-comment-header-27214" class="dsq-comment-header">
            <cite id="dsq-cite-27214">
                <span id="dsq-author-user-27214">bhumit</span>
            </cite>
        </div>
        <div id="dsq-comment-body-27214" class="dsq-comment-body">
            <div id="dsq-comment-message-27214" class="dsq-comment-message"><p>in dp approach the middle for loop should be<br />
for(i=1;i&lt;n-L+1;++i)<br />
and<br />
not for(i=1;i&lt;=n-L+1;++i)<br />
because j=i+L-1</p>
</div>
        </div>

    </li><!-- #comment-## -->
    <li class="comment odd alt thread-odd thread-alt depth-1" id="dsq-comment-24850">
        <div id="dsq-comment-header-24850" class="dsq-comment-header">
            <cite id="dsq-cite-24850">
                <span id="dsq-author-user-24850">piki</span>
            </cite>
        </div>
        <div id="dsq-comment-body-24850" class="dsq-comment-body">
            <div id="dsq-comment-message-24850" class="dsq-comment-message"><p>is my program correct which is taking O(n^2) times i think less than O(n^3)&#8230;&#8230;&#8230;please check</p>
<pre> <code language="C">
 //Actually i want to learn DP
#include&lt;stdio.h&gt;
#include&lt;iostream&gt;
#include&lt;limits.h&gt;

using namespace std;

struct dim
{
  int left;
  int right;
};

int main()
{
  int N,i,j,x,y,z,w,cost1,pp;
  cin&gt;&gt;N;
  dim d[N+1];
  int dp[N+1][N+1];
  cout&lt;&lt;&quot;Enter size array\n&quot;;
  cin&gt;&gt;d[1].left;
  for(i=2;i&lt;=N;i++)
  {
     cin&gt;&gt;pp;
     d[i-1].right=pp;
     d[i].left=pp;
  }
  cin&gt;&gt;pp;
  d[N].right=pp;
 
  
  //matrix print
 // for(i=1;i&lt;=N+1;i++)
  // cout&lt;&lt;d[i].left&lt;&lt;&quot;   &quot;&lt;&lt;d[i].right&lt;&lt;endl;
  //cout&lt;&lt;&quot;done\n\n&quot;;
  
  //main logic
  for(i=1;i&lt;=N;i++)
  {
    
    dp[i][i]=0;
    
  }
 
  for(i=N-1;i&gt;=1;i--)
  {
     for(j=i+1;j&lt;=N;j++)
     {
         int s1=dp[i][j-1];
         int s2=dp[i+1][j];
         int cost1=d[i].left*d[j-1].right*d[j].right;
         int cost2=d[i+1].left*d[j].right*d[i].left;
         dp[i][j]=min(s1+cost1,s2+cost2);
    }
  }
 //print Dp
 for(i=1;i&lt;=N;i++)
 {
    for(j=1;j&lt;=N;j++)
     cout&lt;&lt;dp[i][j]&lt;&lt;&quot;  &quot;;
     cout&lt;&lt;&quot;\n&quot;;
 }
 cout&lt;&lt;&quot;cost         &quot;&lt;&lt;endl;
 cout&lt;&lt;dp[1][N]&lt;&lt;endl;
  return 0;
} 
</code> </pre>
</div>
        </div>

    </li><!-- #comment-## -->
    <li class="comment even thread-even depth-1" id="dsq-comment-24847">
        <div id="dsq-comment-header-24847" class="dsq-comment-header">
            <cite id="dsq-cite-24847">
                <span id="dsq-author-user-24847">piki</span>
            </cite>
        </div>
        <div id="dsq-comment-body-24847" class="dsq-comment-body">
            <div id="dsq-comment-message-24847" class="dsq-comment-message"><p>is my program correct which is taking O(n^2) times i think less than O(n^3)&#8230;&#8230;&#8230;please check</p>
<pre> <code language="C">
/* //Actually i want to learn DP
#include&lt;stdio.h&gt;
#include&lt;iostream&gt;
#include&lt;limits.h&gt;

using namespace std;

struct dim
{
  int left;
  int right;
};

int main()
{
  int N,i,j,x,y,z,w,cost1,pp;
  cin&gt;&gt;N;
  dim d[N+1];
  int dp[N+1][N+1];
  cout&lt;&lt;&quot;Enter size array\n&quot;;
  cin&gt;&gt;d[1].left;
  for(i=2;i&lt;=N;i++)
  {
     cin&gt;&gt;pp;
     d[i-1].right=pp;
     d[i].left=pp;
  }
  cin&gt;&gt;pp;
  d[N].right=pp;
 
  
  //matrix print
 // for(i=1;i&lt;=N+1;i++)
  // cout&lt;&lt;d[i].left&lt;&lt;&quot;   &quot;&lt;&lt;d[i].right&lt;&lt;endl;
  //cout&lt;&lt;&quot;done\n\n&quot;;
  
  //main logic
  for(i=1;i&lt;=N;i++)
  {
    
    dp[i][i]=0;
    
  }
 
  for(i=N-1;i&gt;=1;i--)
  {
     for(j=i+1;j&lt;=N;j++)
     {
         int s1=dp[i][j-1];
         int s2=dp[i+1][j];
         int cost1=d[i].left*d[j-1].right*d[j].right;
         int cost2=d[i+1].left*d[j].right*d[i].left;
         dp[i][j]=min(s1+cost1,s2+cost2);
    }
  }
 //print Dp
 for(i=1;i&lt;=N;i++)
 {
    for(j=1;j&lt;=N;j++)
     cout&lt;&lt;dp[i][j]&lt;&lt;&quot;  &quot;;
     cout&lt;&lt;&quot;\n&quot;;
 }
 cout&lt;&lt;&quot;cost         &quot;&lt;&lt;endl;
 cout&lt;&lt;dp[1][N]&lt;&lt;endl;
  return 0;
} */
</code> </pre>
</div>
        </div>

    </li><!-- #comment-## -->
    <li class="comment odd alt thread-odd thread-alt depth-1" id="dsq-comment-24846">
        <div id="dsq-comment-header-24846" class="dsq-comment-header">
            <cite id="dsq-cite-24846">
                <span id="dsq-author-user-24846">piki</span>
            </cite>
        </div>
        <div id="dsq-comment-body-24846" class="dsq-comment-body">
            <div id="dsq-comment-message-24846" class="dsq-comment-message"><p>this is correct or not please check this approach is taking O(n^2) time&#8230;&#8230;&#8230;&#8230;.</p>
<pre> <code language="C">
/* //Actually i want to learn DP
#include&lt;stdio.h&gt;
#include&lt;iostream&gt;
#include&lt;limits.h&gt;

using namespace std;

struct dim
{
  int left;
  int right;
};

int main()
{
  int N,i,j,x,y,z,w,cost1,pp;
  cin&gt;&gt;N;
  dim d[N+1];
  int dp[N+1][N+1];
  cout&lt;&lt;&quot;Enter size array\n&quot;;
  cin&gt;&gt;d[1].left;
  for(i=2;i&lt;=N;i++)
  {
     cin&gt;&gt;pp;
     d[i-1].right=pp;
     d[i].left=pp;
  }
  cin&gt;&gt;pp;
  d[N].right=pp;
 
  
  //matrix print
 // for(i=1;i&lt;=N+1;i++)
  // cout&lt;&lt;d[i].left&lt;&lt;&quot;   &quot;&lt;&lt;d[i].right&lt;&lt;endl;
  //cout&lt;&lt;&quot;done\n\n&quot;;
  
  //main logic
  for(i=1;i&lt;=N;i++)
  {
    
    dp[i][i]=0;
    
  }
 
  for(i=N-1;i&gt;=1;i--)
  {
     for(j=i+1;j&lt;=N;j++)
     {
         int s1=dp[i][j-1];
         int s2=dp[i+1][j];
         int cost1=d[i].left*d[j-1].right*d[j].right;
         int cost2=d[i+1].left*d[j].right*d[i].left;
         dp[i][j]=min(s1+cost1,s2+cost2);
    }
  }
 //print Dp
 for(i=1;i&lt;=N;i++)
 {
    for(j=1;j&lt;=N;j++)
     cout&lt;&lt;dp[i][j]&lt;&lt;&quot;  &quot;;
     cout&lt;&lt;&quot;\n&quot;;
 }
 cout&lt;&lt;&quot;cost         &quot;&lt;&lt;endl;
 cout&lt;&lt;dp[1][N]&lt;&lt;endl;
  return 0;
} (You may delete these lines if not writing code) */
</code> </pre>
</div>
        </div>

    </li><!-- #comment-## -->
    <li class="comment byuser comment-author-equation even thread-even depth-1" id="dsq-comment-22184">
        <div id="dsq-comment-header-22184" class="dsq-comment-header">
            <cite id="dsq-cite-22184">
                <span id="dsq-author-user-22184">equation</span>
            </cite>
        </div>
        <div id="dsq-comment-body-22184" class="dsq-comment-body">
            <div id="dsq-comment-message-22184" class="dsq-comment-message"><p>working code is here&#8230;&#8230;<br />
source -Cormen book</p>
<pre> <code language="C">

#include&lt;iostream&gt;
#include&lt;conio.h&gt;
using namespace std;

int chain_mul(int p[],int n){
    
    int m[n+1][n+1];
    
    for(int i=1;i&lt;=n;i++)
    m[i][i]=0;
    
    
    for(int l=2;l&lt;=n;l++){
            
    for(int i=1;i&lt;=n-l+1;i++){
    
    int j=i+l-1;
    
    m[i][j]=INT_MAX;
    
    for(int k=i;k&lt;j;k++)
    {
    int q=(m[i][k]+m[k+1][j]+p[i-1]*p[k]*p[j]);
    
    if(m[i][j]&gt;q)
    m[i][j]=q;
    
                    }
                    }
                    } 
return m[1][n];
}


int main(){
    
    int p[]={1,2,3,4};
    int size = sizeof(p)/sizeof(p[0]);
    
    cout&lt;&lt;chain_mul(p,size-1);
    
    getchar();
    return 0;
}





</code> </pre>
</div>
        </div>

    </li><!-- #comment-## -->
    <li class="comment odd alt thread-odd thread-alt depth-1" id="dsq-comment-19567">
        <div id="dsq-comment-header-19567" class="dsq-comment-header">
            <cite id="dsq-cite-19567">
                <span id="dsq-author-user-19567">raghson</span>
            </cite>
        </div>
        <div id="dsq-comment-body-19567" class="dsq-comment-body">
            <div id="dsq-comment-message-19567" class="dsq-comment-message"><p>I think the condition in second for loop should be</p>
<p>for(i=1;i&lt;=n-l+1;i++)</p>
<p>should be replaced by </p>
<p>for(i=1;i&lt;n-l+1;i++)</p>
<p>otherwise it goes out of the bound and starts calculating m[i][4] (as far as this example is concerned.) But, the maximum value j can hold is 3 (n-1). Please update the code above or correct me.</p>
</div>
        </div>

    <ul class="children">
    <li class="comment even depth-2" id="dsq-comment-19569">
        <div id="dsq-comment-header-19569" class="dsq-comment-header">
            <cite id="dsq-cite-19569">
                <span id="dsq-author-user-19569">magnet</span>
            </cite>
        </div>
        <div id="dsq-comment-body-19569" class="dsq-comment-body">
            <div id="dsq-comment-message-19569" class="dsq-comment-message"><p>Let L = j ? i + 1 denote the length of the subchain being multiplied. The subchains of length 1 (m[i, i]) are trivial. Then we build up by computing the subchains of length 2, 3, &#8230;, n. The final answer is m[1, n].</p>
<p>Now set up the loop: Observe that if a subchain of length L starts at position i, then j = i + L ? 1. Since, we would like to keep j in bounds, this means we want j ? n, this, in turn, means that we want i + L ? 1 ? n, actually what we are saying here is that we want i ? n ? L +1. This gives us the closed interval for i. So our loop for i runs from 1 to n ? L + 1.:)</p>
</div>
        </div>

    <ul class="children">
    <li class="comment odd alt depth-3" id="dsq-comment-19574">
        <div id="dsq-comment-header-19574" class="dsq-comment-header">
            <cite id="dsq-cite-19574">
                <span id="dsq-author-user-19574">raghson</span>
            </cite>
        </div>
        <div id="dsq-comment-body-19574" class="dsq-comment-body">
            <div id="dsq-comment-message-19574" class="dsq-comment-message"><p>Hey, Thanks for reply.<br />
Though, I would request you to do the following. </p>
<p>Please paste this line<br />
printf (&#8220;\n%d %d %d&#8221;,i,j, m[i][j]); </p>
<p>just before the inner loop exits. </p>
<p>i.e.,</p>
<p> if (q &lt; m[i][j])<br />
                   { printf(&quot;\nChanged!&quot;);<br />
                    m[i][j] = q;}<br />
            }<br />
            printf (&quot;\n%d %d %d&quot;,i,j, m[i][j]);<br />
        }<br />
    }</p>
<p>You will get line for j =4 and m[i][j] will give garbage values which is obvious because m[i][4] does not exist in the current matrix. Max. value hold by column variable is 3. Please correct me if I am wrong.</p>
</div>
        </div>

    </li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
    <li class="comment even thread-even depth-1" id="dsq-comment-19512">
        <div id="dsq-comment-header-19512" class="dsq-comment-header">
            <cite id="dsq-cite-19512">
                <span id="dsq-author-user-19512">magnet</span>
            </cite>
        </div>
        <div id="dsq-comment-body-19512" class="dsq-comment-body">
            <div id="dsq-comment-message-19512" class="dsq-comment-message"><p>Can you please explain recursive version of the code.</p>
</div>
        </div>

    <ul class="children">
    <li class="comment odd alt depth-2" id="dsq-comment-19514">
        <div id="dsq-comment-header-19514" class="dsq-comment-header">
            <cite id="dsq-cite-19514">
                <span id="dsq-author-user-19514">magnet</span>
            </cite>
        </div>
        <div id="dsq-comment-body-19514" class="dsq-comment-body">
            <div id="dsq-comment-message-19514" class="dsq-comment-message"><p>beautifully explained</p>
<p><a href="http://www.personal.kent.edu/~rmuhamma/Algorithms/MyAlgorithms/Dynamic/chainMatrixMult.htm" rel="nofollow">http://www.personal.kent.edu/~rmuhamma/Algorithms/MyAlgorithms/Dynamic/chainMatrixMult.htm</a></p>
</div>
        </div>

    </li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
    <li class="comment byuser comment-author-abhishek08aug even thread-odd thread-alt depth-1" id="dsq-comment-19175">
        <div id="dsq-comment-header-19175" class="dsq-comment-header">
            <cite id="dsq-cite-19175">
                <span id="dsq-author-user-19175">abhishek08aug</span>
            </cite>
        </div>
        <div id="dsq-comment-body-19175" class="dsq-comment-body">
            <div id="dsq-comment-message-19175" class="dsq-comment-message"><p>Intelligent <img src="http://d2o58evtke57tz.cloudfront.net/wp-includes/images/smilies/icon_biggrin.gif" alt=":D" class="wp-smiley" /></p>
</div>
        </div>

    </li><!-- #comment-## -->
</li><!-- #comment-## -->
    <li class="comment odd alt thread-even depth-1" id="dsq-comment-17097">
        <div id="dsq-comment-header-17097" class="dsq-comment-header">
            <cite id="dsq-cite-17097">
                <span id="dsq-author-user-17097">dambigan</span>
            </cite>
        </div>
        <div id="dsq-comment-body-17097" class="dsq-comment-body">
            <div id="dsq-comment-message-17097" class="dsq-comment-message"><p>can anyone tell me how to do the same using one dimensional matrix m and s.</p>
</div>
        </div>

    </li><!-- #comment-## -->
</li><!-- #comment-## -->
</li><!-- #comment-## -->
</li><!-- #comment-## -->
</li><!-- #comment-## -->
</li><!-- #comment-## -->
</li><!-- #comment-## -->
    <li class="comment even thread-odd thread-alt depth-1" id="dsq-comment-15239">
        <div id="dsq-comment-header-15239" class="dsq-comment-header">
            <cite id="dsq-cite-15239">
                <span id="dsq-author-user-15239">Shikhar Singh</span>
            </cite>
        </div>
        <div id="dsq-comment-body-15239" class="dsq-comment-body">
            <div id="dsq-comment-message-15239" class="dsq-comment-message"><p>The given algorithm is wrong</p>
<pre> <code language="C">
/* Paste your code here (You may delete these lines if not writing code) */
</code> </pre>
</div>
        </div>

    <ul class="children">
    <li class="comment byuser comment-author-geeksforgeeks bypostauthor odd alt depth-2" id="dsq-comment-15240">
        <div id="dsq-comment-header-15240" class="dsq-comment-header">
            <cite id="dsq-cite-15240">
                <span id="dsq-author-user-15240">GeeksforGeeks</span>
            </cite>
        </div>
        <div id="dsq-comment-body-15240" class="dsq-comment-body">
            <div id="dsq-comment-message-15240" class="dsq-comment-message"><p>Could you provide more details? Any input for which the algorithm doesn&#8217;t give correct output?</p>
</div>
        </div>

    </li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
    <li class="comment even thread-even depth-1" id="dsq-comment-8959">
        <div id="dsq-comment-header-8959" class="dsq-comment-header">
            <cite id="dsq-cite-8959">
                <span id="dsq-author-user-8959">Karthick</span>
            </cite>
        </div>
        <div id="dsq-comment-body-8959" class="dsq-comment-body">
            <div id="dsq-comment-message-8959" class="dsq-comment-message"><p>This is a great web site.  Lot of interesting info. Kudos.<br />
My first comment/contribution.  </p>
<p>A good extension to this problem would be to know the multiplication-sequence/multiplication-result (of the minimum count of multiplications that has been found).</p>
<p>This should be easy to do with the following IF  block </p>
<pre> <code language="C">
if (q &lt; m[i][j])
            m[i][j] = q; 
</code> </pre>
<p>modified to maintain one more detail (the K value that determines the parenthesis)</p>
<pre> <code language="C">
if (q &lt; m[i][j]){
            m[i][j] = q; 
            mult_order[i][j]= k;
}
</code> </pre>
<p>And later call a recursive procedure that returns the final multiplied value</p>
<pre> <code language="C">
//this method recursively calls itself and does multiplication //between matrices A_i.....A_k  &amp; A_k+1.........A_j
int matrixMultiplication(int A[], int mult_order[][], int i, int j){
   //we need to ret
   return matrixMultiplication(A,mult_order,i,mult_order[i][j]) * matrixMultiplication(A, mult_order, mult_order[i][j]+1,j);
}
</code> </pre>
<p>The above method is called as matrixMultiplication(A,mult_order,1,n); </p>
<p>Note: Concept is already there defined on a lot of university sites.  I just wanted to extend the existing problem in this link.</p>
<p>Let me know what you think&#8230;</p>
</div>
        </div>

    </li><!-- #comment-## -->
    <li class="comment odd alt thread-odd thread-alt depth-1" id="dsq-comment-8649">
        <div id="dsq-comment-header-8649" class="dsq-comment-header">
            <cite id="dsq-cite-8649">
                <span id="dsq-author-user-8649">swan</span>
            </cite>
        </div>
        <div id="dsq-comment-body-8649" class="dsq-comment-body">
            <div id="dsq-comment-message-8649" class="dsq-comment-message"><p>I think i should stop such that j becomes less than n</p>
<pre> <code language="C">
/* Paste your code here (You may delete these lines if not writing code) */
</code> </pre>
<p>// L is chain length.<br />
    for (L=2; L&lt;n; L++)<br />
    {<br />
        for (i=1; i&lt;=n-L+1; i++)  &lt;&#8212;&#8212;&#8212;&#8212;-  may be i&lt;n-L+1<br />
        {<br />
            j = i+L-1;<br />
            m[i][j] = INT_MAX;<br />
            for (k=i; k&lt;=j-1; k++)<br />
            {<br />
                // q = cost/scalar multiplications<br />
                q = m[i][k] + m[k+1][j] + p[i-1]*p[k]*p[j];<br />
                if (q &lt; m[i][j])<br />
                    m[i][j] = q;<br />
            }<br />
        }<br />
    }</p>
</div>
        </div>

    </li><!-- #comment-## -->
    <li class="comment even thread-even depth-1" id="dsq-comment-7594">
        <div id="dsq-comment-header-7594" class="dsq-comment-header">
            <cite id="dsq-cite-7594">
                <span id="dsq-author-user-7594">kartikaditya</span>
            </cite>
        </div>
        <div id="dsq-comment-body-7594" class="dsq-comment-body">
            <div id="dsq-comment-message-7594" class="dsq-comment-message"><p>public class MatrixChainMult {<br />
    private static class Matrix {<br />
        int n, m;<br />
    }</p>
<p>    public int leastCostToMult(Matrix mats[]) {<br />
        // Validate mult<br />
        for (int i = 1; i &lt; mats.length; ++i) {<br />
            if (mats[i].n != mats[i &#8211; 1].m) {<br />
                return -1;<br />
            }<br />
        }</p>
<p>        int dp[mats.length][mats.length];<br />
        for (int i = 0; i &lt; mats.length; ++i) {<br />
            dp[i][i] = 0;<br />
        }<br />
        for (int len = 1; len &lt; mats.length; ++len) {<br />
            for (int i = 0; i + len &lt; mats.length; ++i) {<br />
                int j = i + len;<br />
                int cost = Integer.MAX_VALUE;<br />
                for (int k = i; k &lt; j; ++k) {<br />
                    int temp = dp[i][k] + dp[k + 1][j] +<br />
                        mats[i].n * mats[k].m * mats[j].m;<br />
                    if (cost &gt; temp) {<br />
                        cost = temp;<br />
                    }<br />
                }<br />
                dp[i][j] = cost;<br />
            }<br />
        }<br />
        return dp[0][mats.length &#8211; 1];<br />
    }<br />
}</p>
</div>
        </div>

    </li><!-- #comment-## -->
    <li class="comment byuser comment-author-vikas368 odd alt thread-odd thread-alt depth-1" id="dsq-comment-7380">
        <div id="dsq-comment-header-7380" class="dsq-comment-header">
            <cite id="dsq-cite-7380">
                <span id="dsq-author-user-7380">vikas368</span>
            </cite>
        </div>
        <div id="dsq-comment-body-7380" class="dsq-comment-body">
            <div id="dsq-comment-message-7380" class="dsq-comment-message"><pre> <code language="C">
for (L=2; L&lt;n; L++)
should be 
for (L=2; L&lt;=n; L++)

return value should be
return m[1][n];
</code> </pre>
</div>
        </div>

    <ul class="children">
    <li class="comment byuser comment-author-kartik even depth-2" id="dsq-comment-7480">
        <div id="dsq-comment-header-7480" class="dsq-comment-header">
            <cite id="dsq-cite-7480">
                <span id="dsq-author-user-7480">kartik</span>
            </cite>
        </div>
        <div id="dsq-comment-body-7480" class="dsq-comment-body">
            <div id="dsq-comment-message-7480" class="dsq-comment-message"><p>@vikas368:  The conditions given in the original program look correct.  Could you please let us know why you felt that the conditions are incorrect? Did the original program fail for any case?</p>
</div>
        </div>

    </li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
    <li class="comment byuser comment-author-psychocoder odd alt thread-even depth-1" id="dsq-comment-7373">
        <div id="dsq-comment-header-7373" class="dsq-comment-header">
            <cite id="dsq-cite-7373">
                <span id="dsq-author-user-7373">PsychoCoder</span>
            </cite>
        </div>
        <div id="dsq-comment-body-7373" class="dsq-comment-body">
            <div id="dsq-comment-message-7373" class="dsq-comment-message"><pre> <code language="C">
    // cost is zero when multiplying one matrix.
    for (i = 1; i &lt; n; i++)
        m[i][i] = 0;
</code> </pre>
<p>Here loop must iterate upto n. i.e. as index goes from 1 to n</p>
<pre> <code language="C">
    // cost is zero when multiplying one matrix.
    for (i = 1; i &lt;= n; i++)
        m[i][i] = 0;
</code> </pre>
</div>
        </div>

    <ul class="children">
    <li class="comment byuser comment-author-kartik even depth-2" id="dsq-comment-7375">
        <div id="dsq-comment-header-7375" class="dsq-comment-header">
            <cite id="dsq-cite-7375">
                <span id="dsq-author-user-7375">kartik</span>
            </cite>
        </div>
        <div id="dsq-comment-body-7375" class="dsq-comment-body">
            <div id="dsq-comment-message-7375" class="dsq-comment-message"><p>@PsychoCoder: Take a closer look at the program.  Size of m[][] is nxn as there will n-1 matrices represented by an array p[] of size n.</p>
</div>
        </div>

    <ul class="children">
    <li class="comment byuser comment-author-nileshbits odd alt depth-3" id="dsq-comment-14581">
        <div id="dsq-comment-header-14581" class="dsq-comment-header">
            <cite id="dsq-cite-14581">
                <span id="dsq-author-user-14581">nileshbits</span>
            </cite>
        </div>
        <div id="dsq-comment-body-14581" class="dsq-comment-body">
            <div id="dsq-comment-message-14581" class="dsq-comment-message"><p>Well there is a little contradiction in the code&#8230; the first line says &#8211; &#8220;// Matrix Ai has dimension p[i-1] x p[i] for i = 1..n&#8221; which seems to imply there are n matrices and p is filled from 0 to n.</p>
<p>I was surprised to see it return m[1][n-1]. I did a dry run and I&#8217;m convinced that there is a flaw somewhere in that code. Here&#8217;s how:</p>
<p>Lets take the last iterations for all the loops:<br />
L = n-1<br />
i = n-L+1 = n-(n-1)+1 = 2<br />
j = i+L-1 = 2+(n-1)-1 = n</p>
<p>Wait &#8211; that makes it [2][n] &#8211; which means you are calculating upto m[2][n] &#8211;> which is bound to be erroneous since you only declared m[n][n] and that means it should be used only upto (n-1) like you pointed out.</p>
<p>You might want to check that piece of code.</p>
<p>On the other hand &#8211; great resource mate! Gotta thank you for this website <img src="http://d2o58evtke57tz.cloudfront.net/wp-includes/images/smilies/icon_smile.gif" alt=":)" class="wp-smiley" /></p>
</div>
        </div>

    </li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
    <li class="comment even thread-odd thread-alt depth-1" id="dsq-comment-7354">
        <div id="dsq-comment-header-7354" class="dsq-comment-header">
            <cite id="dsq-cite-7354">
                <span id="dsq-author-user-7354">g1</span>
            </cite>
        </div>
        <div id="dsq-comment-body-7354" class="dsq-comment-body">
            <div id="dsq-comment-message-7354" class="dsq-comment-message"><p>how to print placements of parenthesis in the minimum cost solution?</p>
</div>
        </div>

    <ul class="children">
    <li class="comment odd alt depth-2" id="dsq-comment-25041">
        <div id="dsq-comment-header-25041" class="dsq-comment-header">
            <cite id="dsq-cite-25041">
                <span id="dsq-author-user-25041">Ikshu</span>
            </cite>
        </div>
        <div id="dsq-comment-body-25041" class="dsq-comment-body">
            <div id="dsq-comment-message-25041" class="dsq-comment-message"><p>1) Make an auxilliary matrix s[n][n] to store &#8220;k&#8221; that gives an optimal placement of parenthesis.<br />
2) Change the code given to one shown below</p>
<pre> <code language="C"> 
       for (k=i; k&lt;=j-1; k++)
       {
           // q = cost/scalar multiplications
           q = m[i][k] + m[k+1][j] + p[i-1]*p[k]*p[j];
            if (q &lt; m[i][j])
            {
                m[i][j] = q;
                s[i][j]=k;
            }
        }
</code> </pre>
<p>3) Use the following function to print the expression with parenthesis.</p>
<pre> <code language="C">
/* Paste your code here (You may delete these lines if not writing code) */void printparenthesis(int i,int j)
{
    if (i==j) cout&lt;&lt;'A'&lt;&lt;i;
    else
    {
        cout&lt;&lt;&quot;(&quot;;
        printparenthesis(i,s[i][j]);
        printparenthesis(s[i][j]+1,j);
        cout&lt;&lt;&quot;)&quot;;
    }
}
</code> </pre>
</div>
        </div>

    </li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
            </ul>


        </div>

    </div>

<script type="text/javascript">
var disqus_url = 'http://www.geeksforgeeks.org/dynamic-programming-set-8-matrix-chain-multiplication/';
var disqus_identifier = '15553 http://www.geeksforgeeks.org/?p=15553';
var disqus_container_id = 'disqus_thread';
var disqus_shortname = 'geeksforgeeks';
var disqus_title = "Dynamic Programming | Set 8 (Matrix Chain Multiplication)";
var disqus_config_custom = window.disqus_config;
var disqus_config = function () {
    /*
    All currently supported events:
    onReady: fires when everything is ready,
    onNewComment: fires when a new comment is posted,
    onIdentify: fires when user is authenticated
    */
    
    
    this.language = '';
    
    if (disqus_config_custom) {
        disqus_config_custom.call(this);
    }
};

(function() {
    var dsq = document.createElement('script'); dsq.type = 'text/javascript';
    dsq.async = true;
    dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
    (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
})();
</script>

			</div>
	
					
			
			

		</div> <!-- end post -->	

<br></br>
	
</div> <!-- end content -->

<ul id="sidebar">
	<li id="text-19" class="widget widget_text">			<div class="textwidget"><script>
  (function() {
    var cx = '009682134359037907028:tj6eafkv_be';
    var gcse = document.createElement('script');
    gcse.type = 'text/javascript';
    gcse.async = true;
    gcse.src = (document.location.protocol == 'https:' ? 'https:' : 'http:') +
        '//www.google.com/cse/cse.js?cx=' + cx;
    var s = document.getElementsByTagName('script')[0];
    s.parentNode.insertBefore(gcse, s);
  })();
</script>
<gcse:search></gcse:search>

<style type="text/css">
  .gsc-control-cse {
    font-family: "Trebuchet MS", sans-serif;
    border-color: #E1F3DA;
    background-color: #E1F3DA;
  }
  input.gsc-input {
    border-color: #94CC7A;
  }
  input.gsc-search-button {
    border-color: #94CC7A;
    background-color: #AADA92;
  }
  .gsc-tabHeader.gsc-tabhInactive {
    border-color: #A9DA92;
    background-color: #FFFFFF;
  }
  .gsc-tabHeader.gsc-tabhActive {
    border-color: #A9DA92;
    background-color: #A9DA92;
  }
  .gsc-tabsArea {
    border-color: #A9DA92;
  }
  .gsc-webResult.gsc-result {
    border-color: #A9DA92;
    background-color: #FFFFFF;
  }
  .gsc-webResult.gsc-result:hover {
    border-color: #A9DA92;
    background-color: #FFFFFF;
  }
  .gs-webResult.gs-result a.gs-title:link,
  .gs-webResult.gs-result a.gs-title:link b {
    color: #009900;
  }
  .gs-webResult.gs-result a.gs-title:visited,
  .gs-webResult.gs-result a.gs-title:visited b {
    color: #009900;
  }
  .gs-webResult.gs-result a.gs-title:hover,
  .gs-webResult.gs-result a.gs-title:hover b {
    color: #003300;
  }
  .gs-webResult.gs-result a.gs-title:active,
  .gs-webResult.gs-result a.gs-title:active b {
    color: #009900;
  }
  .gsc-cursor-page {
    color: #009900;
  }
  a.gsc-trailing-more-results:link {
    color: #009900;
  }
  .gs-webResult.gs-result .gs-snippet {
    color: #454545;
  }
  .gs-webResult.gs-result .gs-visibleUrl {
    color: #33cc00;
  }
  .gs-webResult.gs-result .gs-visibleUrl-short {
    color: #33cc00;
  }
  .gs-webResult.gs-result .gs-visibleUrl-short {
    display: none;
  }
  .gs-webResult.gs-result .gs-visibleUrl-long {
    display: block;
  }
  .gsc-cursor-box {
    border-color: #A9DA92;
  }
  .gsc-results .gsc-cursor-page {
    border-color: #A9DA92;
    background-color: #FFFFFF;
  }
  .gsc-results .gsc-cursor-page.gsc-cursor-current-page {
    border-color: #A9DA92;
    background-color: #A9DA92;
  }
  .gs-promotion.gs-result {
    border-color: #94CC7A;
    background-color: #CBE8B4;
  }
  .gs-promotion.gs-result a.gs-title:link {
    color: #0066CC;
  }
  .gs-promotion.gs-result a.gs-title:visited {
    color: #0066CC;
  }
  .gs-promotion.gs-result a.gs-title:hover {
    color: #0066CC;
  }
  .gs-promotion.gs-result a.gs-title:active {
    color: #0066CC;
  }
  .gs-promotion.gs-result .gs-snippet {
    color: #454545;
  }
  .gs-promotion.gs-result .gs-visibleUrl,
  .gs-promotion.gs-result .gs-visibleUrl-short {
    color: #815FA7;
  }
</style>    </div>
		</li>
<li id="text-9" class="widget widget_text">			<div class="textwidget"><div id="fb-root"></div>
<script>(function(d, s, id) {
  var js, fjs = d.getElementsByTagName(s)[0];
  if (d.getElementById(id)) return;
  js = d.createElement(s); js.id = id;
  js.src = "//connect.facebook.net/en_US/all.js#xfbml=1&appId=138031159685820";
  fjs.parentNode.insertBefore(js, fjs);
}(document, 'script', 'facebook-jssdk'));</script>

<div class="fb-like-box" data-href="https://www.facebook.com/pages/GeeksforGeeks/316764689022" data-width="250" data-height="170" data-colorscheme="light" data-show-faces="true" data-header="false" data-stream="false" data-show-border="false"></div></div>
		</li>
<li id="text-18" class="widget widget_text">			<div class="textwidget"><script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
<!-- LargeRectangleSide -->
<ins class="adsbygoogle"
     style="display:inline-block;width:336px;height:280px"
     data-ad-client="ca-pub-9465609616171866"
     data-ad-slot="1884636833"></ins>
<script>
(adsbygoogle = window.adsbygoogle || []).push({});
</script></div>
		</li>
<li id="text-13" class="widget widget_text">			<div class="textwidget"><ul><li><a href="http://www.geeksforgeeks.org/category/interview-experiences/">Interview Experiences</a></li>
<li><a href="http://www.geeksforgeeks.org/tag/advance-data-structures">Advanced Data Structures</a></li>
<li><a href="http://www.geeksforgeeks.org/tag/dynamic-programming">Dynamic Programming</a></li>
<li><a href="http://www.geeksforgeeks.org/tag/Greedy-Algorithm/">Greedy Algorithms</a></li>
<li><a href="http://www.geeksforgeeks.org/tag/backtracking">Backtracking</a></li>
<li><a href="http://www.geeksforgeeks.org/tag/pattern-searching">Pattern Searching</a></li>
<li><a href="http://www.geeksforgeeks.org/tag/divide-and-conquer">Divide & Conquer</a></li>
<li><a href="http://www.geeksforgeeks.org/tag/MathematicalAlgo">Mathematical Algorithms</a></li>
<li><a href="http://www.geeksforgeeks.org/tag/recursion">Recursion</a></li>
<li><a href="http://www.geeksforgeeks.org/tag/geometric-algorithms/">Geometric Algorithms</a></li>
</ul></div>
		</li>
<li id="text-17" class="widget widget_text">			<div class="textwidget"><script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
<!-- Big 300x600 Sidebar -->
<ins class="adsbygoogle"
     style="display:inline-block;width:300px;height:600px"
     data-ad-client="ca-pub-9465609616171866"
     data-ad-slot="4402736037"></ins>
<script>
(adsbygoogle = window.adsbygoogle || []).push({});
</script></div>
		</li>
<li id="text-14" class="widget widget_text"><h2 class="widgettitle">Popular Posts</h2>
			<div class="textwidget"><ul>
<li><a href="http://www.geeksforgeeks.org/write-a-c-program-to-print-all-permutations-of-a-given-string/">  All permutations of a given string </a></li>
<li><a href="http://www.geeksforgeeks.org/memory-layout-of-c-program/"> Memory Layout of C Programs</a> </li>
<li><a href="http://www.geeksforgeeks.org/understanding-extern-keyword-in-c/"> Understanding “extern” keyword in C</a> </li>
<li><a href="http://www.geeksforgeeks.org/median-of-two-sorted-arrays/">Median of two sorted arrays</a> </li>
<li><a href="http://www.geeksforgeeks.org/inorder-tree-traversal-without-recursion-and-without-stack/"> Tree traversal without recursion and without stack! </a></li>
<li><a href="http://www.geeksforgeeks.org/structure-member-alignment-padding-and-data-packing/"> Structure Member Alignment, Padding and Data Packing</a> </li>
<li><a href="http://www.geeksforgeeks.org/write-a-function-to-get-the-intersection-point-of-two-linked-lists/"> Intersection point of two Linked Lists</a> </li>
<li><a href="http://www.geeksforgeeks.org/lowest-common-ancestor-in-a-binary-search-tree/"> Lowest Common Ancestor in a BST.</span></a> </li>
<li><a href="http://www.geeksforgeeks.org/a-program-to-check-if-a-binary-tree-is-bst-or-not/"> Check if a binary tree is BST or not</a> </li>
<li><a href="http://www.geeksforgeeks.org/sorted-linked-list-to-balanced-bst/"> Sorted Linked List to Balanced BST</a></li>
</ul></div>
		</li>
<li id="text-3" class="widget widget_text">			<div class="textwidget"><a href="https://twitter.com/GeeksforGeeks" class="twitter-follow-button" data-show-count="false">Follow @GeeksforGeeks</a>
<script>!function(d,s,id){var js,fjs=d.getElementsByTagName(s)[0];if(!d.getElementById(id)){js=d.createElement(s);js.id=id;js.src="//platform.twitter.com/widgets.js";fjs.parentNode.insertBefore(js,fjs);}}(document,"script","twitter-wjs");</script>         


<!-- GOOGLE FEEDBURNER BUTTON-->
<a href="http://feeds.feedburner.com/Geeksforgeeks" title="Subscribe to my feed" rel="alternate" type="application/rss+xml"><img src="http://www.feedburner.com/fb/images/pub/feed-icon32x32.png" alt="" style="border:0"/></a><a href="http://feeds.feedburner.com/Geeksforgeeks" title="Subscribe to my feed" rel="alternate" type="application/rss+xml">Subscribe</a>

</div>
		</li>
<li id="text-21" class="widget widget_text"><h2 class="widgettitle">Recent Comments</h2>
			<div class="textwidget"><script type="text/javascript" src="http://geeksforgeeks.disqus.com//recent_comments_widget.js?num_items=6&hide_avatars=1&excerpt_length=50&hide_mods=0"></script></div>
		</li>
<li id="text-22" class="widget widget_text">			<div class="textwidget"><script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
<!-- LinkAd -->
<ins class="adsbygoogle"
     style="display:inline-block;width:160px;height:90px"
     data-ad-client="ca-pub-9465609616171866"
     data-ad-slot="2606115235"></ins>
<script>
(adsbygoogle = window.adsbygoogle || []).push({});
</script>

<script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
<!-- LinkAd -->
<ins class="adsbygoogle"
     style="display:inline-block;width:160px;height:90px"
     data-ad-client="ca-pub-9465609616171866"
     data-ad-slot="2606115235"></ins>
<script>
(adsbygoogle = window.adsbygoogle || []).push({});
</script>

<script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
<!-- LinkAd -->
<ins class="adsbygoogle"
     style="display:inline-block;width:160px;height:90px"
     data-ad-client="ca-pub-9465609616171866"
     data-ad-slot="2606115235"></ins>
<script>
(adsbygoogle = window.adsbygoogle || []).push({});
</script></div>
		</li>

</ul>					  
		<div class="clear"></div>

		<div id="footer">
		
		    <div class="xhtml">
                        @geeksforgeeks, <a href="http://creativecommons.org/licenses/by-nc-nd/2.5/in/deed.en_US" title="Valid XHTML Strict 1.0">Some rights reserved</a>  <a href="http://www.geeksforgeeks.org/about/contact-us/"> &nbsp; &nbsp; &nbsp; &nbsp;Contact Us!</a>

		    </div>
		    
		    <div class="credits">
			  Powered by <a href="http://wordpress.org">WordPress </a> &amp; <a href="http://mootools.net/" title="Mootools JavaScript Framework">MooTools</a>, customized by geeksforgeeks team </div>
			  
		   <div class="clear"></div>						                            
		   
		</div> <!--end footer-->  
        
		        <script type="text/javascript">
        // <![CDATA[
        var disqus_shortname = 'geeksforgeeks';
        (function () {
            var nodes = document.getElementsByTagName('span');
            for (var i = 0, url; i < nodes.length; i++) {
                if (nodes[i].className.indexOf('dsq-postid') != -1) {
                    nodes[i].parentNode.setAttribute('data-disqus-identifier', nodes[i].getAttribute('rel'));
                    url = nodes[i].parentNode.href.split('#', 1);
                    if (url.length == 1) { url = url[0]; }
                    else { url = url[1]; }
                    nodes[i].parentNode.href = url + '#disqus_thread';
                }
            }
            var s = document.createElement('script'); 
            s.async = true;
            s.type = 'text/javascript';
            s.src = '//' + disqus_shortname + '.disqus.com/count.js';
            (document.getElementsByTagName('HEAD')[0] || document.getElementsByTagName('BODY')[0]).appendChild(s);
        }());
        // ]]>
        </script>
        <script type='text/javascript' src='http://d2o58evtke57tz.cloudfront.net/wp-content/plugins/syntaxhighlighter/syntaxhighlighter3/scripts/shCore.js?ver=3.0.9'></script>
<script type='text/javascript' src='http://d2o58evtke57tz.cloudfront.net/wp-content/plugins/syntaxhighlighter/syntaxhighlighter3/scripts/shBrushCpp.js?ver=3.0.9'></script>
<script type='text/javascript'>
	(function(){
		var corecss = document.createElement('link');
		var themecss = document.createElement('link');
		var corecssurl = "http://d2o58evtke57tz.cloudfront.net/wp-content/plugins/syntaxhighlighter/syntaxhighlighter3/styles/shCore.css?ver=3.0.9";
		if ( corecss.setAttribute ) {
				corecss.setAttribute( "rel", "stylesheet" );
				corecss.setAttribute( "type", "text/css" );
				corecss.setAttribute( "href", corecssurl );
		} else {
				corecss.rel = "stylesheet";
				corecss.href = corecssurl;
		}
		document.getElementsByTagName("head")[0].insertBefore( corecss, document.getElementById("syntaxhighlighteranchor") );
		var themecssurl = "http://d2o58evtke57tz.cloudfront.net/wp-content/plugins/syntaxhighlighter/syntaxhighlighter3/styles/shThemeDefault.css?ver=3.0.9";
		if ( themecss.setAttribute ) {
				themecss.setAttribute( "rel", "stylesheet" );
				themecss.setAttribute( "type", "text/css" );
				themecss.setAttribute( "href", themecssurl );
		} else {
				themecss.rel = "stylesheet";
				themecss.href = themecssurl;
		}
		//document.getElementById("syntaxhighlighteranchor").appendChild(themecss);
		document.getElementsByTagName("head")[0].insertBefore( themecss, document.getElementById("syntaxhighlighteranchor") );
	})();
	SyntaxHighlighter.config.strings.expandSource = '+ expand source';
	SyntaxHighlighter.config.strings.help = '?';
	SyntaxHighlighter.config.strings.alert = 'SyntaxHighlighter\n\n';
	SyntaxHighlighter.config.strings.noBrush = 'Can\'t find brush for: ';
	SyntaxHighlighter.config.strings.brushNotHtmlScript = 'Brush wasn\'t configured for html-script option: ';
	SyntaxHighlighter.defaults['gutter'] = false;
	SyntaxHighlighter.defaults['pad-line-numbers'] = true;
	SyntaxHighlighter.defaults['toolbar'] = false;
	SyntaxHighlighter.all();
</script>
<script type='text/javascript' src='http://d2o58evtke57tz.cloudfront.net/wp-content/plugins/bbpress/templates/default/js/editor.js?ver=2.5.4-5380'></script>
				  
		</div> <!--end wrapper-->
        <div id="ajaxSpinner"></div> <!--For AJAX spinner holder-->
<script type="text/javascript">

  var _gaq = _gaq || [];
  _gaq.push(['_setAccount', 'UA-12148232-1']);
  _gaq.push(['_trackPageview']);

  (function() {
    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
  })();

</script>
	</body>

</html>
<!-- Dynamic page generated in 0.215 seconds. -->
<!-- Cached page generated by WP-Super-Cache on 2014-11-27 23:28:04 -->

<!-- Compression = gzip -->
<!-- super cache -->